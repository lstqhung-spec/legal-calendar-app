<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTIC Legal Admin - Qu·∫£n l√Ω</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .sidebar-link.active { background: #1e40af; color: white; }
        .modal { display: none; }
        .modal.show { display: flex; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app">
        <!-- Login Screen -->
        <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-blue-700 p-4">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md p-8">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                        </svg>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">HTIC Legal Admin</h1>
                    <p class="text-gray-500">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω</p>
                </div>
                <form id="loginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="username" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="admin">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">M·∫≠t kh·∫©u</label>
                        <input type="password" id="password" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">ƒêƒÉng nh·∫≠p</button>
                    <p id="loginError" class="text-red-500 text-center hidden"></p>
                </form>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="hidden">
            <div class="flex min-h-screen">
                <!-- Sidebar -->
                <div class="w-64 bg-blue-900 text-white fixed h-full overflow-y-auto">
                    <div class="p-6 border-b border-blue-800">
                        <h1 class="text-xl font-bold">HTIC Legal</h1>
                        <p class="text-blue-300 text-sm">Trang Qu·∫£n Tr·ªã</p>
                    </div>
                    <nav class="p-4 space-y-2">
                        <a href="#" class="sidebar-link active flex items-center gap-3 px-4 py-3 rounded-xl" data-section="dashboard">üìä T·ªïng quan</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="settings">‚öôÔ∏è C√†i ƒë·∫∑t App</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="events">üìÖ L·ªãch ph√°p l√Ω</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="news">üì∞ Tin t·ª©c</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="agencies">üèõÔ∏è C∆° quan NN</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="businesses">üè¢ Doanh nghi·ªáp</a>
                        <a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800" data-section="provinces">üìç T·ªânh/Th√†nh</a>
                    </nav>
                    <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-blue-800">
                        <button id="logoutBtn" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-blue-800">üö™ ƒêƒÉng xu·∫•t</button>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="flex-1 ml-64">
                    <header class="bg-white shadow-sm px-8 py-4 flex justify-between items-center sticky top-0 z-10">
                        <h2 id="pageTitle" class="text-xl font-bold text-gray-800">T·ªïng quan</h2>
                        <span id="adminName" class="text-gray-600"></span>
                    </header>

                    <main class="p-8">
                        <!-- Dashboard -->
                        <section id="section-dashboard" class="section">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <p class="text-gray-500 text-sm font-medium">L·ªãch ph√°p l√Ω</p>
                                    <p id="stat-events" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                                </div>
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <p class="text-gray-500 text-sm font-medium">Tin t·ª©c</p>
                                    <p id="stat-news" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                                </div>
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <p class="text-gray-500 text-sm font-medium">C∆° quan NN</p>
                                    <p id="stat-agencies" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                                </div>
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <p class="text-gray-500 text-sm font-medium">Doanh nghi·ªáp</p>
                                    <p id="stat-businesses" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                                </div>
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <p class="text-gray-500 text-sm font-medium">T·ªânh/Th√†nh</p>
                                    <p id="stat-provinces" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                                </div>
                            </div>
                        </section>

                        <!-- Settings / Logo Upload -->
                        <section id="section-settings" class="section hidden">
                            <div class="max-w-2xl">
                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6">
                                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <span class="text-2xl">üñºÔ∏è</span> Logo ·ª®ng d·ª•ng
                                    </h3>
                                    <p class="text-gray-600 text-sm mb-4">Upload logo s·∫Ω hi·ªÉn th·ªã trong app v√† trang Splash Screen.</p>
                                    
                                    <div class="flex items-start gap-6">
                                        <div class="flex-shrink-0">
                                            <div id="logoPreview" class="w-32 h-32 bg-gray-100 rounded-2xl flex items-center justify-center border-2 border-dashed border-gray-300 overflow-hidden">
                                                <span class="text-gray-400 text-4xl font-bold">H</span>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <label class="block">
                                                <span class="text-sm font-medium text-gray-700 mb-2 block">Ch·ªçn file logo (PNG, JPG)</span>
                                                <input type="file" id="logoInput" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer">
                                            </label>
                                            <p class="text-xs text-gray-500 mt-2">Khuy·∫øn ngh·ªã: 200x200px, t·ªëi ƒëa 500KB</p>
                                            <div class="flex gap-2 mt-4">
                                                <button id="saveLogo" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                                                    üíæ L∆∞u Logo
                                                </button>
                                                <button id="removeLogo" class="bg-red-100 text-red-600 px-4 py-2 rounded-xl font-semibold hover:bg-red-200">
                                                    üóëÔ∏è X√≥a Logo
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                        <span class="text-2xl">‚ÑπÔ∏è</span> Th√¥ng tin ·ª©ng d·ª•ng
                                    </h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="text-sm font-medium text-gray-700 mb-1 block">T√™n ·ª©ng d·ª•ng</label>
                                            <input type="text" id="appName" value="HTIC Legal" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="text-sm font-medium text-gray-700 mb-1 block">Hotline</label>
                                            <input type="text" id="appPhone" value="0379 044 299" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="text-sm font-medium text-gray-700 mb-1 block">Email</label>
                                            <input type="email" id="appEmail" value="contact@htic.com.vn" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                        </div>
                                        <button id="saveAppInfo" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700">
                                            üíæ L∆∞u th√¥ng tin
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Events -->
                        <section id="section-events" class="section hidden">
                            <div class="flex justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Danh s√°ch l·ªãch ph√°p l√Ω</h3>
                                <button onclick="showModal('eventModal')" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700">+ Th√™m m·ªõi</button>
                            </div>
                            <div class="bg-white rounded-2xl shadow-sm overflow-x-auto border border-gray-100">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Ti√™u ƒë·ªÅ</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Lo·∫°i</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Ng√†y</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">T·∫ßn su·∫•t</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Tr·∫°ng th√°i</th>
                                            <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="eventsTable"></tbody>
                                </table>
                            </div>
                        </section>

                        <!-- News -->
                        <section id="section-news" class="section hidden">
                            <div class="flex justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Danh s√°ch tin t·ª©c</h3>
                                <button onclick="showModal('newsModal')" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700">+ Th√™m m·ªõi</button>
                            </div>
                            <div class="bg-white rounded-2xl shadow-sm overflow-x-auto border border-gray-100">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">H√¨nh ·∫£nh</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Ti√™u ƒë·ªÅ</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Chuy√™n m·ª•c</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Ng√†y</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">N·ªïi b·∫≠t</th>
                                            <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="newsTable"></tbody>
                                </table>
                            </div>
                        </section>

                        <!-- Agencies -->
                        <section id="section-agencies" class="section hidden">
                            <div class="flex justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Danh s√°ch c∆° quan nh√† n∆∞·ªõc</h3>
                                <button onclick="showModal('agencyModal')" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700">+ Th√™m m·ªõi</button>
                            </div>
                            <div class="bg-white rounded-2xl shadow-sm overflow-x-auto border border-gray-100">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">T√™n c∆° quan</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">T·ªânh/Th√†nh</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Lo·∫°i</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">ƒêi·ªán tho·∫°i</th>
                                            <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="agenciesTable"></tbody>
                                </table>
                            </div>
                        </section>

                        <!-- Businesses -->
                        <section id="section-businesses" class="section hidden">
                            <div class="flex justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Danh s√°ch doanh nghi·ªáp</h3>
                                <button onclick="showModal('businessModal')" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700">+ Th√™m m·ªõi</button>
                            </div>
                            <div class="bg-white rounded-2xl shadow-sm overflow-x-auto border border-gray-100">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Logo</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">T√™n DN</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Ng√†nh ngh·ªÅ</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">ƒêi·ªán tho·∫°i</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">Pro</th>
                                            <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="businessesTable"></tbody>
                                </table>
                            </div>
                        </section>

                        <!-- Provinces -->
                        <section id="section-provinces" class="section hidden">
                            <div class="flex justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-800">Danh s√°ch t·ªânh/th√†nh ph·ªë</h3>
                                <button onclick="showModal('provinceModal')" class="bg-blue-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-700">+ Th√™m m·ªõi</button>
                            </div>
                            <div class="bg-white rounded-2xl shadow-sm overflow-x-auto border border-gray-100">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">M√£</th>
                                            <th class="px-6 py-4 text-left text-sm font-semibold text-gray-600">T√™n</th>
                                            <th class="px-6 py-4 text-right text-sm font-semibold text-gray-600">Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="provincesTable"></tbody>
                                </table>
                            </div>
                        </section>
                    </main>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="eventModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white">
                <h3 class="text-lg font-bold text-gray-800">Th√™m/S·ª≠a l·ªãch ph√°p l√Ω</h3>
                <button onclick="hideModal('eventModal')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200">‚úï</button>
            </div>
            <form id="eventForm" class="p-6 space-y-4">
                <input type="hidden" id="eventId">
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Ti√™u ƒë·ªÅ *</label><input type="text" id="eventTitle" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Lo·∫°i</label><select id="eventCategory" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"><option value="tax">Thu·∫ø</option><option value="insurance">BHXH</option><option value="report">B√°o c√°o</option><option value="license">Gi·∫•y ph√©p</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Ng√†y trong th√°ng</label><input type="number" id="eventDay" min="1" max="31" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="20"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T·∫ßn su·∫•t</label><select id="eventFrequency" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"><option value="monthly">H√†ng th√°ng</option><option value="quarterly">H√†ng qu√Ω</option><option value="yearly">H√†ng nƒÉm</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">M√¥ t·∫£</label><textarea id="eventDescription" rows="3" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none"></textarea></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">CƒÉn c·ª© ph√°p l√Ω</label><input type="text" id="eventLegal" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">M·ª©c ph·∫°t</label><input type="text" id="eventPenalty" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div class="flex items-center gap-2"><input type="checkbox" id="eventActive" checked class="w-5 h-5 rounded"><label class="text-sm text-gray-700">K√≠ch ho·∫°t</label></div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">üíæ L∆∞u</button>
            </form>
        </div>
    </div>

    <div id="newsModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white">
                <h3 class="text-lg font-bold text-gray-800">Th√™m/S·ª≠a tin t·ª©c</h3>
                <button onclick="hideModal('newsModal')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200">‚úï</button>
            </div>
            <form id="newsForm" class="p-6 space-y-4">
                <input type="hidden" id="newsId">
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Ti√™u ƒë·ªÅ *</label><input type="text" id="newsTitle" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Chuy√™n m·ª•c</label><input type="text" id="newsCategory" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Thu·∫ø, BHXH, Doanh nghi·ªáp..."></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">URL H√¨nh ·∫£nh</label><input type="url" id="newsImage" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="https://..."></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T√≥m t·∫Øt *</label><textarea id="newsSummary" rows="2" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none"></textarea></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">N·ªôi dung</label><textarea id="newsContent" rows="5" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none"></textarea></div>
                <div class="flex items-center gap-4"><div class="flex items-center gap-2"><input type="checkbox" id="newsHot" class="w-5 h-5 rounded"><label class="text-sm text-gray-700">Tin n·ªïi b·∫≠t</label></div><div class="flex items-center gap-2"><input type="checkbox" id="newsActive" checked class="w-5 h-5 rounded"><label class="text-sm text-gray-700">K√≠ch ho·∫°t</label></div></div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">üíæ L∆∞u</button>
            </form>
        </div>
    </div>

    <div id="agencyModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white">
                <h3 class="text-lg font-bold text-gray-800">Th√™m/S·ª≠a c∆° quan</h3>
                <button onclick="hideModal('agencyModal')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200">‚úï</button>
            </div>
            <form id="agencyForm" class="p-6 space-y-4">
                <input type="hidden" id="agencyId">
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T√™n c∆° quan *</label><input type="text" id="agencyName" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T·ªânh/Th√†nh</label><select id="agencyProvince" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Lo·∫°i c∆° quan</label><select id="agencyCat" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"><option value="tax">Thu·∫ø</option><option value="insurance">BHXH</option><option value="court">T√≤a √°n</option><option value="labor">S·ªü LƒêTBXH</option><option value="business">ƒêƒÉng k√Ω KD</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">ƒê·ªãa ch·ªâ</label><input type="text" id="agencyAddress" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">ƒêi·ªán tho·∫°i</label><input type="text" id="agencyPhone" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div class="flex items-center gap-2"><input type="checkbox" id="agencyActive" checked class="w-5 h-5 rounded"><label class="text-sm text-gray-700">K√≠ch ho·∫°t</label></div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">üíæ L∆∞u</button>
            </form>
        </div>
    </div>

    <div id="businessModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white">
                <h3 class="text-lg font-bold text-gray-800">Th√™m/S·ª≠a doanh nghi·ªáp</h3>
                <button onclick="hideModal('businessModal')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200">‚úï</button>
            </div>
            <form id="businessForm" class="p-6 space-y-4">
                <input type="hidden" id="businessId">
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T√™n doanh nghi·ªáp *</label><input type="text" id="businessName" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">Ng√†nh ngh·ªÅ</label><select id="businessIndustry" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"><option value="trade">Th∆∞∆°ng m·∫°i</option><option value="service">D·ªãch v·ª•</option><option value="manufacturing">S·∫£n xu·∫•t</option><option value="construction">X√¢y d·ª±ng</option><option value="it">CNTT</option><option value="legal">Ph√°p l√Ω</option><option value="accounting">K·∫ø to√°n</option><option value="other">Kh√°c</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">ƒêi·ªán tho·∫°i</label><input type="text" id="businessPhone" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">ƒê·ªãa ch·ªâ</label><input type="text" id="businessAddress" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">URL Logo</label><input type="url" id="businessLogo" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="https://..."></div>
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2"><input type="checkbox" id="businessPro" class="w-5 h-5 rounded"><label class="text-sm text-gray-700">G√≥i Pro</label></div>
                    <div class="flex items-center gap-2"><input type="checkbox" id="businessActive" checked class="w-5 h-5 rounded"><label class="text-sm text-gray-700">K√≠ch ho·∫°t</label></div>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">üíæ L∆∞u</button>
            </form>
        </div>
    </div>

    <div id="provinceModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl w-full max-w-md">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-lg font-bold text-gray-800">Th√™m/S·ª≠a t·ªânh/th√†nh</h3>
                <button onclick="hideModal('provinceModal')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200">‚úï</button>
            </div>
            <form id="provinceForm" class="p-6 space-y-4">
                <input type="hidden" id="provinceId">
                <div><label class="block text-sm font-medium text-gray-700 mb-1">M√£ *</label><input type="text" id="provinceCode" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="hanoi"></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-1">T√™n *</label><input type="text" id="provinceName" required class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="H√† N·ªôi"></div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700">üíæ L∆∞u</button>
            </form>
        </div>
    </div>

    <script>
        const API = '/api';
        let currentLogo = null;

        // Modal functions
        function showModal(id) { document.getElementById(id).classList.add('show'); }
        function hideModal(id) { document.getElementById(id).classList.remove('show'); }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            try {
                const res = await fetch(API + '/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();
                if (data.success) {
                    localStorage.setItem('adminToken', data.token);
                    localStorage.setItem('adminName', data.admin.name);
                    showDashboard();
                } else {
                    document.getElementById('loginError').textContent = data.message;
                    document.getElementById('loginError').classList.remove('hidden');
                }
            } catch (err) {
                document.getElementById('loginError').textContent = 'L·ªói k·∫øt n·ªëi server';
                document.getElementById('loginError').classList.remove('hidden');
            }
        });

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminDashboard').classList.remove('hidden');
            document.getElementById('adminName').textContent = localStorage.getItem('adminName') || 'Admin';
            loadStats();
            loadAllData();
            loadAppSettings();
        }

        // Logout
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminName');
            location.reload();
        });

        // Check login on load
        if (localStorage.getItem('adminToken')) {
            showDashboard();
        }

        // Sidebar navigation
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.dataset.section;
                document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
                document.getElementById('section-' + section).classList.remove('hidden');
                document.getElementById('pageTitle').textContent = link.textContent.trim();
            });
        });

        // Load stats
        async function loadStats() {
            try {
                const res = await fetch(API + '/admin/stats');
                const data = await res.json();
                if (data.success) {
                    document.getElementById('stat-events').textContent = data.data.events?.total || 0;
                    document.getElementById('stat-news').textContent = data.data.news?.total || 0;
                    document.getElementById('stat-agencies').textContent = data.data.agencies?.total || 0;
                    document.getElementById('stat-businesses').textContent = data.data.businesses?.total || 0;
                    document.getElementById('stat-provinces').textContent = data.data.provinces?.total || 0;
                }
            } catch (err) { console.error(err); }
        }

        // Load all data
        async function loadAllData() {
            loadEvents();
            loadNews();
            loadAgencies();
            loadBusinesses();
            loadProvinces();
        }

        // === APP SETTINGS / LOGO ===
        async function loadAppSettings() {
            try {
                const res = await fetch(API + '/settings/logo');
                const data = await res.json();
                if (data.success && data.data?.logo) {
                    currentLogo = data.data.logo;
                    document.getElementById('logoPreview').innerHTML = `<img src="${data.data.logo}" class="w-full h-full object-contain">`;
                }
            } catch (err) { console.error(err); }
        }

        document.getElementById('logoInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = () => {
                    currentLogo = reader.result;
                    document.getElementById('logoPreview').innerHTML = `<img src="${currentLogo}" class="w-full h-full object-contain">`;
                    document.getElementById('saveLogo').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        });

        document.getElementById('saveLogo').addEventListener('click', async () => {
            if (!currentLogo) return;
            try {
                const res = await fetch(API + '/admin/settings/logo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ logo: currentLogo })
                });
                const data = await res.json();
                if (data.success) {
                    alert('‚úÖ ƒê√£ l∆∞u logo th√†nh c√¥ng!');
                    document.getElementById('saveLogo').disabled = true;
                } else {
                    alert('‚ùå L·ªói: ' + data.message);
                }
            } catch (err) {
                alert('‚ùå L·ªói k·∫øt n·ªëi server');
            }
        });

        document.getElementById('removeLogo').addEventListener('click', async () => {
            if (!confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a logo?')) return;
            try {
                const res = await fetch(API + '/admin/settings/logo', {
                    method: 'DELETE'
                });
                const data = await res.json();
                if (data.success) {
                    currentLogo = null;
                    document.getElementById('logoPreview').innerHTML = '<span class="text-gray-400 text-4xl font-bold">H</span>';
                    document.getElementById('logoInput').value = '';
                    document.getElementById('saveLogo').disabled = true;
                    alert('‚úÖ ƒê√£ x√≥a logo!');
                }
            } catch (err) {
                alert('‚ùå L·ªói k·∫øt n·ªëi server');
            }
        });

        document.getElementById('saveAppInfo').addEventListener('click', async () => {
            const appName = document.getElementById('appName').value;
            const appPhone = document.getElementById('appPhone').value;
            const appEmail = document.getElementById('appEmail').value;
            try {
                const res = await fetch(API + '/admin/settings/info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: appName, phone: appPhone, email: appEmail })
                });
                const data = await res.json();
                alert(data.success ? '‚úÖ ƒê√£ l∆∞u th√¥ng tin!' : '‚ùå L·ªói: ' + data.message);
            } catch (err) {
                alert('‚ùå L·ªói k·∫øt n·ªëi server');
            }
        });

        // === EVENTS ===
        async function loadEvents() {
            const res = await fetch(API + '/admin/events');
            const data = await res.json();
            const cats = { tax: 'Thu·∫ø', insurance: 'BHXH', report: 'B√°o c√°o', license: 'Gi·∫•y ph√©p' };
            const freqs = { monthly: 'H√†ng th√°ng', quarterly: 'H√†ng qu√Ω', yearly: 'H√†ng nƒÉm' };
            document.getElementById('eventsTable').innerHTML = data.data.map(e => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-900">${e.title}</td>
                    <td class="px-6 py-4"><span class="bg-blue-100 text-blue-700 px-2 py-1 rounded-lg text-sm font-semibold">${cats[e.category] || e.category}</span></td>
                    <td class="px-6 py-4 text-gray-600">Ng√†y ${e.dayOfMonth || 20}</td>
                    <td class="px-6 py-4 text-gray-600">${freqs[e.frequency] || e.frequency}</td>
                    <td class="px-6 py-4">${e.isActive ? '<span class="text-green-600 font-semibold">‚úì Ho·∫°t ƒë·ªông</span>' : '<span class="text-gray-400">T·∫Øt</span>'}</td>
                    <td class="px-6 py-4 text-right space-x-2">
                        <button onclick="editEvent(${e.id})" class="text-blue-600 hover:underline font-medium">S·ª≠a</button>
                        <button onclick="deleteEvent(${e.id})" class="text-red-600 hover:underline font-medium">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        window.editEvent = async (id) => {
            const res = await fetch(API + '/admin/events/' + id);
            const data = await res.json();
            if (data.success) {
                const e = data.data;
                document.getElementById('eventId').value = e.id;
                document.getElementById('eventTitle').value = e.title;
                document.getElementById('eventCategory').value = e.category;
                document.getElementById('eventDay').value = e.dayOfMonth;
                document.getElementById('eventFrequency').value = e.frequency;
                document.getElementById('eventDescription').value = e.description || '';
                document.getElementById('eventLegal').value = e.legalReference || '';
                document.getElementById('eventPenalty').value = e.penalty || '';
                document.getElementById('eventActive').checked = e.isActive;
                showModal('eventModal');
            }
        };

        window.deleteEvent = async (id) => {
            if (!confirm('X√°c nh·∫≠n x√≥a?')) return;
            await fetch(API + '/admin/events/' + id, { method: 'DELETE' });
            loadEvents();
            loadStats();
        };

        document.getElementById('eventForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('eventId').value;
            const body = {
                title: document.getElementById('eventTitle').value,
                category: document.getElementById('eventCategory').value,
                dayOfMonth: parseInt(document.getElementById('eventDay').value) || 20,
                frequency: document.getElementById('eventFrequency').value,
                description: document.getElementById('eventDescription').value,
                legalReference: document.getElementById('eventLegal').value,
                penalty: document.getElementById('eventPenalty').value,
                isActive: document.getElementById('eventActive').checked
            };
            const url = id ? API + '/admin/events/' + id : API + '/admin/events';
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
            hideModal('eventModal');
            document.getElementById('eventForm').reset();
            document.getElementById('eventId').value = '';
            loadEvents();
            loadStats();
        });

        // === NEWS ===
        async function loadNews() {
            const res = await fetch(API + '/admin/news');
            const data = await res.json();
            document.getElementById('newsTable').innerHTML = data.data.map(n => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4">${n.image ? `<img src="${n.image}" class="w-16 h-12 object-cover rounded-lg">` : '<div class="w-16 h-12 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400">üì∞</div>'}</td>
                    <td class="px-6 py-4 font-medium text-gray-900 max-w-xs truncate">${n.title}</td>
                    <td class="px-6 py-4"><span class="bg-purple-100 text-purple-700 px-2 py-1 rounded-lg text-sm font-semibold">${n.category}</span></td>
                    <td class="px-6 py-4 text-gray-600">${n.date}</td>
                    <td class="px-6 py-4">${n.isHot ? '<span class="text-orange-500 font-semibold">üî• Hot</span>' : '-'}</td>
                    <td class="px-6 py-4 text-right space-x-2">
                        <button onclick="editNews(${n.id})" class="text-blue-600 hover:underline font-medium">S·ª≠a</button>
                        <button onclick="deleteNews(${n.id})" class="text-red-600 hover:underline font-medium">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        window.editNews = async (id) => {
            const res = await fetch(API + '/admin/news/' + id);
            const data = await res.json();
            if (data.success) {
                const n = data.data;
                document.getElementById('newsId').value = n.id;
                document.getElementById('newsTitle').value = n.title;
                document.getElementById('newsCategory').value = n.category;
                document.getElementById('newsImage').value = n.image || '';
                document.getElementById('newsSummary').value = n.summary;
                document.getElementById('newsContent').value = n.content || '';
                document.getElementById('newsHot').checked = n.isHot;
                document.getElementById('newsActive').checked = n.isActive;
                showModal('newsModal');
            }
        };

        window.deleteNews = async (id) => {
            if (!confirm('X√°c nh·∫≠n x√≥a?')) return;
            await fetch(API + '/admin/news/' + id, { method: 'DELETE' });
            loadNews();
            loadStats();
        };

        document.getElementById('newsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('newsId').value;
            const body = {
                title: document.getElementById('newsTitle').value,
                category: document.getElementById('newsCategory').value,
                image: document.getElementById('newsImage').value,
                summary: document.getElementById('newsSummary').value,
                content: document.getElementById('newsContent').value,
                isHot: document.getElementById('newsHot').checked,
                isActive: document.getElementById('newsActive').checked,
                date: new Date().toLocaleDateString('vi-VN')
            };
            const url = id ? API + '/admin/news/' + id : API + '/admin/news';
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
            hideModal('newsModal');
            document.getElementById('newsForm').reset();
            document.getElementById('newsId').value = '';
            loadNews();
            loadStats();
        });

        // === AGENCIES ===
        let provincesData = [];
        async function loadProvinces() {
            const res = await fetch(API + '/provinces');
            const data = await res.json();
            provincesData = data.data || [];
            document.getElementById('agencyProvince').innerHTML = provincesData.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
            document.getElementById('provincesTable').innerHTML = provincesData.map(p => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-900">${p.id}</td>
                    <td class="px-6 py-4 text-gray-600">${p.name}</td>
                    <td class="px-6 py-4 text-right">
                        <button onclick="deleteProvince('${p.id}')" class="text-red-600 hover:underline font-medium">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        async function loadAgencies() {
            const res = await fetch(API + '/admin/agencies');
            const data = await res.json();
            const cats = { tax: 'Thu·∫ø', insurance: 'BHXH', court: 'T√≤a √°n', labor: 'S·ªü LƒêTBXH', business: 'ƒêƒÉng k√Ω KD' };
            document.getElementById('agenciesTable').innerHTML = data.data.map(a => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4 font-medium text-gray-900">${a.name}</td>
                    <td class="px-6 py-4 text-gray-600">${provincesData.find(p => p.id === a.provinceId)?.name || a.provinceId}</td>
                    <td class="px-6 py-4"><span class="bg-green-100 text-green-700 px-2 py-1 rounded-lg text-sm font-semibold">${cats[a.category] || a.category}</span></td>
                    <td class="px-6 py-4 text-gray-600">${a.phone || '-'}</td>
                    <td class="px-6 py-4 text-right space-x-2">
                        <button onclick="editAgency(${a.id})" class="text-blue-600 hover:underline font-medium">S·ª≠a</button>
                        <button onclick="deleteAgency(${a.id})" class="text-red-600 hover:underline font-medium">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        window.editAgency = async (id) => {
            const res = await fetch(API + '/admin/agencies/' + id);
            const data = await res.json();
            if (data.success) {
                const a = data.data;
                document.getElementById('agencyId').value = a.id;
                document.getElementById('agencyName').value = a.name;
                document.getElementById('agencyProvince').value = a.provinceId;
                document.getElementById('agencyCat').value = a.category;
                document.getElementById('agencyAddress').value = a.address || '';
                document.getElementById('agencyPhone').value = a.phone || '';
                document.getElementById('agencyActive').checked = a.isActive;
                showModal('agencyModal');
            }
        };

        window.deleteAgency = async (id) => {
            if (!confirm('X√°c nh·∫≠n x√≥a?')) return;
            await fetch(API + '/admin/agencies/' + id, { method: 'DELETE' });
            loadAgencies();
            loadStats();
        };

        document.getElementById('agencyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('agencyId').value;
            const body = {
                name: document.getElementById('agencyName').value,
                provinceId: document.getElementById('agencyProvince').value,
                category: document.getElementById('agencyCat').value,
                address: document.getElementById('agencyAddress').value,
                phone: document.getElementById('agencyPhone').value,
                isActive: document.getElementById('agencyActive').checked
            };
            const url = id ? API + '/admin/agencies/' + id : API + '/admin/agencies';
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
            hideModal('agencyModal');
            document.getElementById('agencyForm').reset();
            document.getElementById('agencyId').value = '';
            loadAgencies();
            loadStats();
        });

        // === BUSINESSES ===
        async function loadBusinesses() {
            const res = await fetch(API + '/admin/businesses');
            const data = await res.json();
            const industries = { trade: 'Th∆∞∆°ng m·∫°i', service: 'D·ªãch v·ª•', manufacturing: 'S·∫£n xu·∫•t', construction: 'X√¢y d·ª±ng', it: 'CNTT', legal: 'Ph√°p l√Ω', accounting: 'K·∫ø to√°n', other: 'Kh√°c' };
            document.getElementById('businessesTable').innerHTML = (data.data || []).map(b => `
                <tr class="border-t hover:bg-gray-50">
                    <td class="px-6 py-4">${b.logo ? `<img src="${b.logo}" class="w-12 h-12 object-cover rounded-xl">` : '<div class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center text-gray-400">üè¢</div>'}</td>
                    <td class="px-6 py-4 font-medium text-gray-900">${b.name}</td>
                    <td class="px-6 py-4 text-gray-600">${industries[b.industry] || b.industry}</td>
                    <td class="px-6 py-4 text-gray-600">${b.phone || '-'}</td>
                    <td class="px-6 py-4">${b.isPro ? '<span class="bg-amber-100 text-amber-700 px-2 py-1 rounded-lg text-sm font-bold">PRO</span>' : '-'}</td>
                    <td class="px-6 py-4 text-right space-x-2">
                        <button onclick="editBusiness(${b.id})" class="text-blue-600 hover:underline font-medium">S·ª≠a</button>
                        <button onclick="deleteBusiness(${b.id})" class="text-red-600 hover:underline font-medium">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        window.editBusiness = async (id) => {
            const res = await fetch(API + '/admin/businesses/' + id);
            const data = await res.json();
            if (data.success) {
                const b = data.data;
                document.getElementById('businessId').value = b.id;
                document.getElementById('businessName').value = b.name;
                document.getElementById('businessIndustry').value = b.industry;
                document.getElementById('businessPhone').value = b.phone || '';
                document.getElementById('businessAddress').value = b.address || '';
                document.getElementById('businessLogo').value = b.logo || '';
                document.getElementById('businessPro').checked = b.isPro;
                document.getElementById('businessActive').checked = b.isActive;
                showModal('businessModal');
            }
        };

        window.deleteBusiness = async (id) => {
            if (!confirm('X√°c nh·∫≠n x√≥a?')) return;
            await fetch(API + '/admin/businesses/' + id, { method: 'DELETE' });
            loadBusinesses();
            loadStats();
        };

        document.getElementById('businessForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('businessId').value;
            const body = {
                name: document.getElementById('businessName').value,
                industry: document.getElementById('businessIndustry').value,
                phone: document.getElementById('businessPhone').value,
                address: document.getElementById('businessAddress').value,
                logo: document.getElementById('businessLogo').value,
                isPro: document.getElementById('businessPro').checked,
                isActive: document.getElementById('businessActive').checked
            };
            const url = id ? API + '/admin/businesses/' + id : API + '/admin/businesses';
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
            hideModal('businessModal');
            document.getElementById('businessForm').reset();
            document.getElementById('businessId').value = '';
            loadBusinesses();
            loadStats();
        });

        // === PROVINCES ===
        document.getElementById('provinceForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const body = {
                id: document.getElementById('provinceCode').value,
                name: document.getElementById('provinceName').value
            };
            await fetch(API + '/admin/provinces', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
            hideModal('provinceModal');
            document.getElementById('provinceForm').reset();
            loadProvinces();
            loadStats();
        });

        window.deleteProvince = async (id) => {
            if (!confirm('X√°c nh·∫≠n x√≥a?')) return;
            await fetch(API + '/admin/provinces/' + id, { method: 'DELETE' });
            loadProvinces();
            loadStats();
        };
    </script>
</body>
</html>
