<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTIC Legal - Admin Panel v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .sidebar-item.active { background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%); color: white; }
        .sidebar-item:hover:not(.active) { background: #f1f5f9; }
        .card { transition: all 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .modal { display: none; }
        .modal.active { display: flex; }
        .tab-btn.active { border-bottom: 2px solid #3b82f6; color: #3b82f6; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Modal -->
    <div id="loginModal" class="modal active fixed inset-0 bg-black/50 items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 w-full max-w-md shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-scale-balanced text-white text-2xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">HTIC Legal Admin</h2>
                <p class="text-gray-500 mt-1">Đăng nhập để quản lý hệ thống</p>
            </div>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tên đăng nhập</label>
                    <input type="text" id="username" value="admin" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="admin">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mật khẩu</label>
                    <input type="password" id="password" value="htic2025" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="••••••••">
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition">
                    <i class="fas fa-sign-in-alt mr-2"></i>Đăng nhập
                </button>
            </form>
            <p id="loginError" class="text-red-500 text-center mt-4 hidden">Sai tên đăng nhập hoặc mật khẩu</p>
        </div>
    </div>

    <!-- Main Layout -->
    <div id="mainApp" class="hidden flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200 fixed h-full">
            <div class="p-6 border-b border-gray-100">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center">
                        <i class="fas fa-scale-balanced text-white"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-gray-800">HTIC Legal</h1>
                        <p class="text-xs text-gray-500">Admin Panel v2.0</p>
                    </div>
                </div>
            </div>
            <nav class="p-4 space-y-1">
                <a href="#" onclick="showSection('dashboard')" class="sidebar-item active flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-chart-pie w-5"></i> Dashboard
                </a>
                <a href="#" onclick="showSection('events')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-calendar-check w-5"></i> Sự kiện pháp lý
                </a>
                <a href="#" onclick="showSection('news')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-newspaper w-5"></i> Tin tức
                </a>
                <a href="#" onclick="showSection('agencies')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-building-columns w-5"></i> Cơ quan pháp lý
                </a>
                <a href="#" onclick="showSection('users')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-users w-5"></i> Người dùng
                </a>
                <a href="#" onclick="showSection('subscriptions')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-crown w-5"></i> Gói dịch vụ
                </a>
                <a href="#" onclick="showSection('company')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-building w-5"></i> Thông tin công ty
                </a>
                <a href="#" onclick="showSection('settings')" class="sidebar-item flex items-center gap-3 px-4 py-3 rounded-xl text-gray-600">
                    <i class="fas fa-cog w-5"></i> Cài đặt
                </a>
            </nav>
            <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-100">
                <button onclick="logout()" class="w-full flex items-center justify-center gap-2 px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl transition">
                    <i class="fas fa-sign-out-alt"></i> Đăng xuất
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-8">
            <!-- Dashboard Section -->
            <section id="section-dashboard" class="section">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Dashboard</h2>
                    <p class="text-gray-500">Tổng quan hệ thống HTIC Legal App</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card bg-white rounded-2xl p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Sự kiện pháp lý</p>
                                <p id="stat-events" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-calendar-check text-blue-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-white rounded-2xl p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Tin tức</p>
                                <p id="stat-news" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-newspaper text-green-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-white rounded-2xl p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Cơ quan</p>
                                <p id="stat-agencies" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-building-columns text-purple-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-white rounded-2xl p-6 border border-gray-100">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Người dùng</p>
                                <p id="stat-users" class="text-3xl font-bold text-gray-800 mt-1">0</p>
                            </div>
                            <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center">
                                <i class="fas fa-users text-orange-600"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl p-6 border border-gray-100">
                    <h3 class="font-semibold text-gray-800 mb-4">API Endpoints</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">GET</span>
                            <code class="text-gray-600">/api/events</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">GET</span>
                            <code class="text-gray-600">/api/news</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">GET</span>
                            <code class="text-gray-600">/api/agencies</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">GET</span>
                            <code class="text-gray-600">/api/subscriptions</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">GET</span>
                            <code class="text-gray-600">/api/company</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium">POST</span>
                            <code class="text-gray-600">/api/auth/register</code>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium">POST</span>
                            <code class="text-gray-600">/api/auth/login</code>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Events Section -->
            <section id="section-events" class="section hidden">
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Sự kiện pháp lý</h2>
                        <p class="text-gray-500">Quản lý lịch pháp lý cho doanh nghiệp</p>
                    </div>
                    <button onclick="openEventModal()" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700 transition flex items-center gap-2">
                        <i class="fas fa-plus"></i> Thêm sự kiện
                    </button>
                </div>
                <div class="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Tiêu đề</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Danh mục</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Hạn chót</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Trạng thái</th>
                                <th class="text-right px-6 py-4 text-sm font-semibold text-gray-600">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="eventsTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </section>

            <!-- News Section -->
            <section id="section-news" class="section hidden">
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Tin tức pháp lý</h2>
                        <p class="text-gray-500">Quản lý tin tức và bài viết</p>
                    </div>
                    <button onclick="openNewsModal()" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700 transition flex items-center gap-2">
                        <i class="fas fa-plus"></i> Thêm tin tức
                    </button>
                </div>
                <div class="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Hình ảnh</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Tiêu đề</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Danh mục</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Ngày</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Nổi bật</th>
                                <th class="text-right px-6 py-4 text-sm font-semibold text-gray-600">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="newsTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </section>

            <!-- Agencies Section -->
            <section id="section-agencies" class="section hidden">
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Cơ quan pháp lý</h2>
                        <p class="text-gray-500">Danh sách cơ quan nhà nước và tổ chức pháp lý</p>
                    </div>
                    <button onclick="openAgencyModal()" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700 transition flex items-center gap-2">
                        <i class="fas fa-plus"></i> Thêm cơ quan
                    </button>
                </div>
                <div class="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Tên cơ quan</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Loại</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Thành phố</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Điện thoại</th>
                                <th class="text-right px-6 py-4 text-sm font-semibold text-gray-600">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="agenciesTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </section>

            <!-- Users Section -->
            <section id="section-users" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Người dùng</h2>
                    <p class="text-gray-500">Danh sách người dùng đã đăng ký</p>
                </div>
                <div class="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Email</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Công ty</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Gói dịch vụ</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Ngày đăng ký</th>
                                <th class="text-left px-6 py-4 text-sm font-semibold text-gray-600">Trạng thái</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </section>

            <!-- Subscriptions Section -->
            <section id="section-subscriptions" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Gói dịch vụ</h2>
                    <p class="text-gray-500">Quản lý các gói dịch vụ</p>
                </div>
                <div id="subscriptionsList" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
            </section>

            <!-- Company Section -->
            <section id="section-company" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Thông tin công ty</h2>
                    <p class="text-gray-500">Cập nhật thông tin Công ty Luật HTIC</p>
                </div>
                <form id="companyForm" class="bg-white rounded-2xl border border-gray-100 p-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tên công ty</label>
                            <input type="text" id="companyName" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tên viết tắt</label>
                            <input type="text" id="companyShortName" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Slogan</label>
                            <input type="text" id="companySlogan" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mô tả</label>
                            <textarea id="companyDescription" rows="3" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Địa chỉ</label>
                            <input type="text" id="companyAddress" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Điện thoại</label>
                            <input type="text" id="companyPhone" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hotline</label>
                            <input type="text" id="companyHotline" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" id="companyEmail" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Website</label>
                            <input type="url" id="companyWebsite" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Giờ làm việc</label>
                            <input type="text" id="companyWorkingHours" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mã số thuế</label>
                            <input type="text" id="companyTaxCode" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button type="submit" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-blue-700 transition">
                            <i class="fas fa-save mr-2"></i>Lưu thông tin
                        </button>
                    </div>
                </form>
            </section>

            <!-- Settings Section -->
            <section id="section-settings" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800">Cài đặt</h2>
                    <p class="text-gray-500">Cấu hình ứng dụng</p>
                </div>
                <form id="settingsForm" class="bg-white rounded-2xl border border-gray-100 p-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tên ứng dụng</label>
                            <input type="text" id="settingAppName" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phiên bản</label>
                            <input type="text" id="settingAppVersion" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Màu chủ đạo</label>
                            <input type="color" id="settingPrimaryColor" class="w-full h-12 border border-gray-200 rounded-xl cursor-pointer">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Logo URL</label>
                            <input type="url" id="settingLogo" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/logo.png">
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button type="submit" class="bg-blue-600 text-white px-8 py-3 rounded-xl font-semibold hover:bg-blue-700 transition">
                            <i class="fas fa-save mr-2"></i>Lưu cài đặt
                        </button>
                    </div>
                </form>
            </section>
        </main>
    </div>

    <!-- Event Modal -->
    <div id="eventModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50">
        <div class="bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-100">
                <h3 id="eventModalTitle" class="text-xl font-bold text-gray-800">Thêm sự kiện mới</h3>
            </div>
            <form id="eventForm" class="p-6 space-y-4">
                <input type="hidden" id="eventId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tiêu đề *</label>
                    <input type="text" id="eventTitle" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Danh mục *</label>
                        <select id="eventCategory" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                            <option value="tax">Thuế</option>
                            <option value="insurance">Bảo hiểm</option>
                            <option value="labor">Lao động</option>
                            <option value="finance">Tài chính</option>
                            <option value="investment">Đầu tư</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Hạn chót *</label>
                        <input type="date" id="eventDeadline" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mô tả</label>
                    <textarea id="eventDescription" rows="3" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Căn cứ pháp lý</label>
                    <input type="text" id="eventLegalBasis" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mức phạt</label>
                    <input type="text" id="eventPenalty" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="eventIsActive" checked class="w-5 h-5 rounded border-gray-300">
                    <label class="text-sm text-gray-700">Kích hoạt</label>
                </div>
                <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
                    <button type="button" onclick="closeEventModal()" class="px-6 py-3 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50">Hủy</button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- News Modal -->
    <div id="newsModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50">
        <div class="bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-100">
                <h3 id="newsModalTitle" class="text-xl font-bold text-gray-800">Thêm tin tức mới</h3>
            </div>
            <form id="newsForm" class="p-6 space-y-4">
                <input type="hidden" id="newsId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tiêu đề *</label>
                    <input type="text" id="newsTitle" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Danh mục *</label>
                        <select id="newsCategory" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                            <option value="tax">Thuế</option>
                            <option value="insurance">Bảo hiểm</option>
                            <option value="labor">Lao động</option>
                            <option value="investment">Đầu tư</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ngày đăng</label>
                        <input type="date" id="newsDate" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">URL Hình ảnh</label>
                    <input type="url" id="newsImageUrl" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/image.jpg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tóm tắt *</label>
                    <textarea id="newsSummary" rows="2" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nội dung *</label>
                    <textarea id="newsContent" rows="5" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="newsIsHot" class="w-5 h-5 rounded border-gray-300">
                    <label class="text-sm text-gray-700">Tin nổi bật</label>
                </div>
                <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
                    <button type="button" onclick="closeNewsModal()" class="px-6 py-3 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50">Hủy</button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Agency Modal -->
    <div id="agencyModal" class="modal fixed inset-0 bg-black/50 items-center justify-center z-50">
        <div class="bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-100">
                <h3 id="agencyModalTitle" class="text-xl font-bold text-gray-800">Thêm cơ quan mới</h3>
            </div>
            <form id="agencyForm" class="p-6 space-y-4">
                <input type="hidden" id="agencyId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Tên cơ quan *</label>
                    <input type="text" id="agencyName" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Loại *</label>
                        <select id="agencyType" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                            <option value="tax">Thuế</option>
                            <option value="insurance">Bảo hiểm</option>
                            <option value="notary">Công chứng</option>
                            <option value="court">Tòa án</option>
                            <option value="police">Công an</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Thành phố *</label>
                        <input type="text" id="agencyCity" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Địa chỉ</label>
                    <input type="text" id="agencyAddress" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Điện thoại</label>
                        <input type="text" id="agencyPhone" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="agencyEmail" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Giờ làm việc</label>
                    <input type="text" id="agencyWorkingHours" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mô tả</label>
                    <textarea id="agencyDescription" rows="3" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
                    <button type="button" onclick="closeAgencyModal()" class="px-6 py-3 border border-gray-200 rounded-xl text-gray-600 hover:bg-gray-50">Hủy</button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700">Lưu</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let authToken = localStorage.getItem('adminToken');

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            try {
                const res = await fetch(`${API_BASE}/api/admin/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();
                if (data.success) {
                    authToken = data.token;
                    localStorage.setItem('adminToken', authToken);
                    document.getElementById('loginModal').classList.remove('active');
                    document.getElementById('mainApp').classList.remove('hidden');
                    loadDashboard();
                } else {
                    document.getElementById('loginError').classList.remove('hidden');
                }
            } catch (err) {
                document.getElementById('loginError').classList.remove('hidden');
            }
        });

        // Check auth on load
        if (authToken) {
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('mainApp').classList.remove('hidden');
            loadDashboard();
        }

        function logout() {
            localStorage.removeItem('adminToken');
            location.reload();
        }

        // Navigation
        function showSection(name) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(`section-${name}`).classList.remove('hidden');
            document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
            event.target.closest('.sidebar-item').classList.add('active');
            
            if (name === 'dashboard') loadDashboard();
            else if (name === 'events') loadEvents();
            else if (name === 'news') loadNews();
            else if (name === 'agencies') loadAgencies();
            else if (name === 'users') loadUsers();
            else if (name === 'subscriptions') loadSubscriptions();
            else if (name === 'company') loadCompany();
            else if (name === 'settings') loadSettings();
        }

        // Dashboard
        async function loadDashboard() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/stats`);
                const data = await res.json();
                if (data.success) {
                    document.getElementById('stat-events').textContent = data.data.events?.total || 0;
                    document.getElementById('stat-news').textContent = data.data.news?.total || 0;
                    document.getElementById('stat-agencies').textContent = data.data.agencies?.total || 0;
                    document.getElementById('stat-users').textContent = data.data.users?.total || 0;
                }
            } catch (err) { console.error(err); }
        }

        // Events
        async function loadEvents() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/events`);
                const data = await res.json();
                const tbody = document.getElementById('eventsTable');
                tbody.innerHTML = data.data.map(e => `
                    <tr>
                        <td class="px-6 py-4"><div class="font-medium text-gray-800">${e.title}</div></td>
                        <td class="px-6 py-4"><span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs">${getCategoryName(e.category)}</span></td>
                        <td class="px-6 py-4 text-gray-600">${e.deadline || ''}</td>
                        <td class="px-6 py-4">${e.isActive ? '<span class="text-green-600">✓ Hoạt động</span>' : '<span class="text-gray-400">Ẩn</span>'}</td>
                        <td class="px-6 py-4 text-right">
                            <button onclick="editEvent(${e.id})" class="text-blue-600 hover:text-blue-800 mr-3"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteEvent(${e.id})" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `).join('');
            } catch (err) { console.error(err); }
        }

        function openEventModal() {
            document.getElementById('eventModalTitle').textContent = 'Thêm sự kiện mới';
            document.getElementById('eventForm').reset();
            document.getElementById('eventId').value = '';
            document.getElementById('eventModal').classList.add('active');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.remove('active');
        }

        async function editEvent(id) {
            const res = await fetch(`${API_BASE}/api/admin/events`);
            const data = await res.json();
            const event = data.data.find(e => e.id === id);
            if (event) {
                document.getElementById('eventModalTitle').textContent = 'Sửa sự kiện';
                document.getElementById('eventId').value = event.id;
                document.getElementById('eventTitle').value = event.title;
                document.getElementById('eventCategory').value = event.category;
                document.getElementById('eventDeadline').value = event.deadline;
                document.getElementById('eventDescription').value = event.description || '';
                document.getElementById('eventLegalBasis').value = event.legalBasis || '';
                document.getElementById('eventPenalty').value = event.penalty || '';
                document.getElementById('eventIsActive').checked = event.isActive;
                document.getElementById('eventModal').classList.add('active');
            }
        }

        document.getElementById('eventForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('eventId').value;
            const eventData = {
                title: document.getElementById('eventTitle').value,
                category: document.getElementById('eventCategory').value,
                deadline: document.getElementById('eventDeadline').value,
                description: document.getElementById('eventDescription').value,
                legalBasis: document.getElementById('eventLegalBasis').value,
                penalty: document.getElementById('eventPenalty').value,
                isActive: document.getElementById('eventIsActive').checked
            };
            const url = id ? `${API_BASE}/api/admin/events/${id}` : `${API_BASE}/api/admin/events`;
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(eventData) });
            closeEventModal();
            loadEvents();
        });

        async function deleteEvent(id) {
            if (confirm('Bạn có chắc muốn xóa sự kiện này?')) {
                await fetch(`${API_BASE}/api/admin/events/${id}`, { method: 'DELETE' });
                loadEvents();
            }
        }

        // News
        async function loadNews() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/news`);
                const data = await res.json();
                const tbody = document.getElementById('newsTable');
                tbody.innerHTML = data.data.map(n => `
                    <tr>
                        <td class="px-6 py-4">
                            ${n.imageUrl ? `<img src="${n.imageUrl}" class="w-16 h-12 object-cover rounded-lg">` : '<div class="w-16 h-12 bg-gray-100 rounded-lg flex items-center justify-center"><i class="fas fa-image text-gray-400"></i></div>'}
                        </td>
                        <td class="px-6 py-4"><div class="font-medium text-gray-800 max-w-xs truncate">${n.title}</div></td>
                        <td class="px-6 py-4"><span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs">${getCategoryName(n.category)}</span></td>
                        <td class="px-6 py-4 text-gray-600">${formatDate(n.date)}</td>
                        <td class="px-6 py-4">${n.isHot ? '<span class="text-orange-500"><i class="fas fa-fire"></i></span>' : ''}</td>
                        <td class="px-6 py-4 text-right">
                            <button onclick="editNews(${n.id})" class="text-blue-600 hover:text-blue-800 mr-3"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteNews(${n.id})" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `).join('');
            } catch (err) { console.error(err); }
        }

        function openNewsModal() {
            document.getElementById('newsModalTitle').textContent = 'Thêm tin tức mới';
            document.getElementById('newsForm').reset();
            document.getElementById('newsId').value = '';
            document.getElementById('newsModal').classList.add('active');
        }

        function closeNewsModal() {
            document.getElementById('newsModal').classList.remove('active');
        }

        async function editNews(id) {
            const res = await fetch(`${API_BASE}/api/admin/news`);
            const data = await res.json();
            const news = data.data.find(n => n.id === id);
            if (news) {
                document.getElementById('newsModalTitle').textContent = 'Sửa tin tức';
                document.getElementById('newsId').value = news.id;
                document.getElementById('newsTitle').value = news.title;
                document.getElementById('newsCategory').value = news.category;
                document.getElementById('newsDate').value = news.date ? news.date.split('T')[0] : '';
                document.getElementById('newsImageUrl').value = news.imageUrl || '';
                document.getElementById('newsSummary').value = news.summary || '';
                document.getElementById('newsContent').value = news.content || '';
                document.getElementById('newsIsHot').checked = news.isHot;
                document.getElementById('newsModal').classList.add('active');
            }
        }

        document.getElementById('newsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('newsId').value;
            const newsData = {
                title: document.getElementById('newsTitle').value,
                category: document.getElementById('newsCategory').value,
                date: document.getElementById('newsDate').value ? new Date(document.getElementById('newsDate').value).toISOString() : new Date().toISOString(),
                imageUrl: document.getElementById('newsImageUrl').value,
                summary: document.getElementById('newsSummary').value,
                content: document.getElementById('newsContent').value,
                isHot: document.getElementById('newsIsHot').checked
            };
            const url = id ? `${API_BASE}/api/admin/news/${id}` : `${API_BASE}/api/admin/news`;
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(newsData) });
            closeNewsModal();
            loadNews();
        });

        async function deleteNews(id) {
            if (confirm('Bạn có chắc muốn xóa tin tức này?')) {
                await fetch(`${API_BASE}/api/admin/news/${id}`, { method: 'DELETE' });
                loadNews();
            }
        }

        // Agencies
        async function loadAgencies() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/agencies`);
                const data = await res.json();
                const tbody = document.getElementById('agenciesTable');
                tbody.innerHTML = data.data.map(a => `
                    <tr>
                        <td class="px-6 py-4"><div class="font-medium text-gray-800">${a.name}</div></td>
                        <td class="px-6 py-4"><span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs">${getTypeName(a.type)}</span></td>
                        <td class="px-6 py-4 text-gray-600">${a.city || ''}</td>
                        <td class="px-6 py-4 text-gray-600">${a.phone || ''}</td>
                        <td class="px-6 py-4 text-right">
                            <button onclick="editAgency(${a.id})" class="text-blue-600 hover:text-blue-800 mr-3"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteAgency(${a.id})" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `).join('');
            } catch (err) { console.error(err); }
        }

        function openAgencyModal() {
            document.getElementById('agencyModalTitle').textContent = 'Thêm cơ quan mới';
            document.getElementById('agencyForm').reset();
            document.getElementById('agencyId').value = '';
            document.getElementById('agencyModal').classList.add('active');
        }

        function closeAgencyModal() {
            document.getElementById('agencyModal').classList.remove('active');
        }

        async function editAgency(id) {
            const res = await fetch(`${API_BASE}/api/admin/agencies`);
            const data = await res.json();
            const agency = data.data.find(a => a.id === id);
            if (agency) {
                document.getElementById('agencyModalTitle').textContent = 'Sửa cơ quan';
                document.getElementById('agencyId').value = agency.id;
                document.getElementById('agencyName').value = agency.name;
                document.getElementById('agencyType').value = agency.type;
                document.getElementById('agencyCity').value = agency.city || '';
                document.getElementById('agencyAddress').value = agency.address || '';
                document.getElementById('agencyPhone').value = agency.phone || '';
                document.getElementById('agencyEmail').value = agency.email || '';
                document.getElementById('agencyWorkingHours').value = agency.workingHours || '';
                document.getElementById('agencyDescription').value = agency.description || '';
                document.getElementById('agencyModal').classList.add('active');
            }
        }

        document.getElementById('agencyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('agencyId').value;
            const agencyData = {
                name: document.getElementById('agencyName').value,
                type: document.getElementById('agencyType').value,
                city: document.getElementById('agencyCity').value,
                address: document.getElementById('agencyAddress').value,
                phone: document.getElementById('agencyPhone').value,
                email: document.getElementById('agencyEmail').value,
                workingHours: document.getElementById('agencyWorkingHours').value,
                description: document.getElementById('agencyDescription').value
            };
            const url = id ? `${API_BASE}/api/admin/agencies/${id}` : `${API_BASE}/api/admin/agencies`;
            const method = id ? 'PUT' : 'POST';
            await fetch(url, { method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(agencyData) });
            closeAgencyModal();
            loadAgencies();
        });

        async function deleteAgency(id) {
            if (confirm('Bạn có chắc muốn xóa cơ quan này?')) {
                await fetch(`${API_BASE}/api/admin/agencies/${id}`, { method: 'DELETE' });
                loadAgencies();
            }
        }

        // Users
        async function loadUsers() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/users`);
                const data = await res.json();
                const tbody = document.getElementById('usersTable');
                if (data.data.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-8 text-center text-gray-500">Chưa có người dùng đăng ký</td></tr>';
                } else {
                    tbody.innerHTML = data.data.map(u => `
                        <tr>
                            <td class="px-6 py-4"><div class="font-medium text-gray-800">${u.email}</div></td>
                            <td class="px-6 py-4 text-gray-600">${u.companyName || '-'}</td>
                            <td class="px-6 py-4"><span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs">${u.subscription || 'free'}</span></td>
                            <td class="px-6 py-4 text-gray-600">${formatDate(u.createdAt)}</td>
                            <td class="px-6 py-4">${u.isActive ? '<span class="text-green-600">✓ Hoạt động</span>' : '<span class="text-gray-400">Khóa</span>'}</td>
                        </tr>
                    `).join('');
                }
            } catch (err) { console.error(err); }
        }

        // Subscriptions
        async function loadSubscriptions() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/subscriptions`);
                const data = await res.json();
                const container = document.getElementById('subscriptionsList');
                container.innerHTML = data.data.map(s => `
                    <div class="bg-white rounded-2xl border border-gray-100 p-6 ${s.popular ? 'ring-2 ring-blue-500' : ''}">
                        ${s.popular ? '<div class="text-center mb-2"><span class="bg-blue-600 text-white px-3 py-1 rounded-full text-xs">PHỔ BIẾN</span></div>' : ''}
                        <h3 class="text-xl font-bold text-gray-800 text-center">${s.name}</h3>
                        <div class="text-center my-4">
                            <span class="text-3xl font-bold text-gray-800">${s.price.toLocaleString()}đ</span>
                            <span class="text-gray-500">/${s.period === 'forever' ? 'mãi mãi' : 'tháng'}</span>
                        </div>
                        <ul class="space-y-2">
                            ${s.features.map(f => `<li class="flex items-center gap-2 text-sm text-gray-600"><i class="fas fa-check text-green-500"></i>${f}</li>`).join('')}
                        </ul>
                    </div>
                `).join('');
            } catch (err) { console.error(err); }
        }

        // Company
        async function loadCompany() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/company`);
                const data = await res.json();
                const c = data.data;
                document.getElementById('companyName').value = c.name || '';
                document.getElementById('companyShortName').value = c.shortName || '';
                document.getElementById('companySlogan').value = c.slogan || '';
                document.getElementById('companyDescription').value = c.description || '';
                document.getElementById('companyAddress').value = c.address || '';
                document.getElementById('companyPhone').value = c.phone || '';
                document.getElementById('companyHotline').value = c.hotline || '';
                document.getElementById('companyEmail').value = c.email || '';
                document.getElementById('companyWebsite').value = c.website || '';
                document.getElementById('companyWorkingHours').value = c.workingHours || '';
                document.getElementById('companyTaxCode').value = c.taxCode || '';
            } catch (err) { console.error(err); }
        }

        document.getElementById('companyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const companyData = {
                name: document.getElementById('companyName').value,
                shortName: document.getElementById('companyShortName').value,
                slogan: document.getElementById('companySlogan').value,
                description: document.getElementById('companyDescription').value,
                address: document.getElementById('companyAddress').value,
                phone: document.getElementById('companyPhone').value,
                hotline: document.getElementById('companyHotline').value,
                email: document.getElementById('companyEmail').value,
                website: document.getElementById('companyWebsite').value,
                workingHours: document.getElementById('companyWorkingHours').value,
                taxCode: document.getElementById('companyTaxCode').value
            };
            await fetch(`${API_BASE}/api/admin/company`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(companyData)
            });
            alert('Đã lưu thông tin công ty!');
        });

        // Settings
        async function loadSettings() {
            try {
                const res = await fetch(`${API_BASE}/api/admin/settings`);
                const data = await res.json();
                const s = data.data;
                document.getElementById('settingAppName').value = s.appName || '';
                document.getElementById('settingAppVersion').value = s.appVersion || '';
                document.getElementById('settingPrimaryColor').value = s.primaryColor || '#136DEC';
                document.getElementById('settingLogo').value = s.logo || '';
            } catch (err) { console.error(err); }
        }

        document.getElementById('settingsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const settingsData = {
                appName: document.getElementById('settingAppName').value,
                appVersion: document.getElementById('settingAppVersion').value,
                primaryColor: document.getElementById('settingPrimaryColor').value,
                logo: document.getElementById('settingLogo').value
            };
            await fetch(`${API_BASE}/api/admin/settings`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(settingsData)
            });
            alert('Đã lưu cài đặt!');
        });

        // Helpers
        function getCategoryName(cat) {
            const names = { tax: 'Thuế', insurance: 'Bảo hiểm', labor: 'Lao động', finance: 'Tài chính', investment: 'Đầu tư' };
            return names[cat] || cat;
        }

        function getTypeName(type) {
            const names = { tax: 'Thuế', insurance: 'Bảo hiểm', notary: 'Công chứng', court: 'Tòa án', police: 'Công an' };
            return names[type] || type;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const d = new Date(dateStr);
            return `${d.getDate().toString().padStart(2, '0')}/${(d.getMonth() + 1).toString().padStart(2, '0')}/${d.getFullYear()}`;
        }
    </script>
</body>
</html>
