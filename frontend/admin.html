<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - HTIC Legal App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>tailwind.config={theme:{extend:{colors:{navy:{50:'#e8eef5',100:'#c5d4e8',500:'#3d6d9e',600:'#1e3a5f',700:'#162d4a'}}}}}</script>
    <style>*{font-family:'Inter',sans-serif}.hide-scrollbar::-webkit-scrollbar{display:none}</style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div id="app"></div>
    <script>
        const API = '/api';
        let token = localStorage.getItem('adminToken');
        let currentSection = 'dashboard';

        const app = document.getElementById('app');

        function checkAuth() {
            if (!token) showLogin();
            else showDashboard();
        }

        function showLogin() {
            app.innerHTML = `
                <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-navy-600 to-navy-700 p-4">
                    <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md">
                        <div class="text-center mb-8">
                            <div class="w-20 h-20 bg-gradient-to-br from-navy-600 to-navy-700 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <span class="text-white text-3xl font-bold">H</span>
                            </div>
                            <h1 class="text-2xl font-bold text-gray-900">HTIC Legal Admin</h1>
                            <p class="text-gray-500 mt-2">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω</p>
                        </div>
                        <div id="loginError" class="hidden bg-red-100 text-red-700 p-3 rounded-lg mb-4 text-sm"></div>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">T√™n ƒëƒÉng nh·∫≠p</label>
                                <input type="text" id="username" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none" placeholder="admin">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">M·∫≠t kh·∫©u</label>
                                <input type="password" id="password" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" onkeypress="if(event.key==='Enter')login()">
                            </div>
                            <button onclick="login()" class="w-full bg-navy-600 text-white py-3 rounded-xl font-bold hover:bg-navy-700 transition">
                                ƒêƒÉng nh·∫≠p
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorEl = document.getElementById('loginError');
            try {
                const res = await fetch(API + '/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();
                if (data.success) {
                    token = data.token;
                    localStorage.setItem('adminToken', token);
                    showDashboard();
                } else {
                    errorEl.textContent = data.message || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i';
                    errorEl.classList.remove('hidden');
                }
            } catch (e) {
                errorEl.textContent = 'L·ªói k·∫øt n·ªëi server';
                errorEl.classList.remove('hidden');
            }
        }

        function logout() {
            token = null;
            localStorage.removeItem('adminToken');
            showLogin();
        }

        async function showDashboard() {
            app.innerHTML = `
                <div class="flex min-h-screen">
                    <div class="w-64 bg-navy-700 text-white p-6 fixed h-full overflow-auto hide-scrollbar">
                        <div class="flex items-center gap-3 mb-8">
                            <div class="w-10 h-10 bg-white rounded-xl flex items-center justify-center">
                                <span class="text-navy-700 font-bold text-lg">H</span>
                            </div>
                            <div>
                                <h1 class="font-bold">HTIC Legal</h1>
                                <p class="text-xs text-navy-200">Admin Panel v8.3</p>
                            </div>
                        </div>
                        <nav class="space-y-2">
                            <button onclick="loadSection('dashboard')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="dashboard">üìä T·ªïng quan</button>
                            <button onclick="loadSection('events')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="events">üìÖ S·ª± ki·ªán</button>
                            <button onclick="loadSection('news')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="news">üì∞ Tin t·ª©c</button>
                            <button onclick="loadSection('agencies')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="agencies">üèõÔ∏è C∆° quan NN</button>
                            <button onclick="loadSection('settings')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="settings">‚öôÔ∏è C√†i ƒë·∫∑t App</button>
                        </nav>
                        <button onclick="logout()" class="absolute bottom-6 left-6 right-6 bg-red-500/20 text-red-300 py-3 rounded-xl hover:bg-red-500/30 font-semibold">üö™ ƒêƒÉng xu·∫•t</button>
                    </div>
                    <div class="ml-64 flex-1 p-8"><div id="content"></div></div>
                </div>
            `;
            loadSection('dashboard');
        }

        function loadSection(section) {
            currentSection = section;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-navy-600');
                if (btn.dataset.section === section) btn.classList.add('bg-navy-600');
            });
            switch(section) {
                case 'dashboard': loadDashboardContent(); break;
                case 'events': loadEventsContent(); break;
                case 'news': loadNewsContent(); break;
                case 'agencies': loadAgenciesContent(); break;
                case 'settings': loadSettingsContent(); break;
            }
        }

        async function loadDashboardContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            try {
                const [statsRes, eventsRes, newsRes] = await Promise.all([
                    fetch(API + '/admin/stats'),
                    fetch(API + '/admin/events'),
                    fetch(API + '/admin/news')
                ]);
                const statsData = await statsRes.json();
                const eventsData = await eventsRes.json();
                const newsData = await newsRes.json();
                const stats = statsData.data || {};
                const events = (eventsData.data || []).slice(0, 5);
                const news = (newsData.data || []).slice(0, 5);
                
                content.innerHTML = `
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">üìä T·ªïng quan</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-2xl">üìÖ</div>
                                <div><p class="text-gray-500 text-sm">S·ª± ki·ªán</p><p class="text-2xl font-bold text-gray-900">${stats.events?.total || 0}</p></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-2xl">üì∞</div>
                                <div><p class="text-gray-500 text-sm">Tin t·ª©c</p><p class="text-2xl font-bold text-gray-900">${stats.news?.total || 0}</p></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center text-2xl">üèõÔ∏è</div>
                                <div><p class="text-gray-500 text-sm">C∆° quan</p><p class="text-2xl font-bold text-gray-900">${stats.agencies?.total || 0}</p></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center text-2xl">üë•</div>
                                <div><p class="text-gray-500 text-sm">Truy c·∫≠p</p><p class="text-2xl font-bold text-gray-900">--</p></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- S·ª± ki·ªán m·ªõi nh·∫•t -->
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-gray-900">üìÖ S·ª± ki·ªán m·ªõi nh·∫•t</h3>
                                <button onclick="loadSection('events')" class="text-navy-600 text-sm font-semibold hover:underline">Xem t·∫•t c·∫£ ‚Üí</button>
                            </div>
                            <div class="space-y-3">
                                ${events.length === 0 ? '<p class="text-gray-500 text-sm">Ch∆∞a c√≥ s·ª± ki·ªán</p>' : events.map(e => `
                                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-sm font-bold text-blue-700">${e.dayOfMonth || 20}</div>
                                        <div class="flex-1 min-w-0">
                                            <p class="font-semibold text-gray-900 text-sm truncate">${e.title}</p>
                                            <p class="text-xs text-gray-500">${e.category} ‚Ä¢ ${e.frequency}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- Tin t·ª©c m·ªõi nh·∫•t -->
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-gray-900">üì∞ Tin t·ª©c m·ªõi nh·∫•t</h3>
                                <button onclick="loadSection('news')" class="text-navy-600 text-sm font-semibold hover:underline">Xem t·∫•t c·∫£ ‚Üí</button>
                            </div>
                            <div class="space-y-3">
                                ${news.length === 0 ? '<p class="text-gray-500 text-sm">Ch∆∞a c√≥ tin t·ª©c</p>' : news.map(n => `
                                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">üìÑ</div>
                                        <div class="flex-1 min-w-0">
                                            <p class="font-semibold text-gray-900 text-sm truncate">${n.title}</p>
                                            <p class="text-xs text-gray-500">${n.category} ‚Ä¢ ${n.date}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ EVENTS - Sorted by newest first ============
        async function loadEventsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            try {
                const res = await fetch(API + '/admin/events');
                const data = await res.json();
                // Sort by ID descending (newest first)
                const events = (data.data || []).sort((a, b) => b.id - a.id);
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üìÖ Qu·∫£n l√Ω S·ª± ki·ªán</h2>
                        <button onclick="showEventForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ID</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Lo·∫°i</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ng√†y</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Tr·∫°ng th√°i</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${events.map(e => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-500">#${e.id}</td>
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${e.title}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold">${e.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">Ng√†y ${e.dayOfMonth || 20}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 ${e.isActive !== false ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'} rounded-full text-xs font-semibold">${e.isActive !== false ? 'Ho·∫°t ƒë·ªông' : '·∫®n'}</span></td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="editEvent(${e.id})" class="text-blue-600 hover:underline text-sm mr-3">S·ª≠a</button>
                                            <button onclick="deleteEvent(${e.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ NEWS - Sorted by newest first ============
        async function loadNewsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            try {
                const res = await fetch(API + '/admin/news');
                const data = await res.json();
                // Sort by ID descending (newest first)
                const news = (data.data || []).sort((a, b) => b.id - a.id);
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üì∞ Qu·∫£n l√Ω Tin t·ª©c</h2>
                        <button onclick="showNewsForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ID</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Danh m·ª•c</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ng√†y ƒëƒÉng</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Hot</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${news.map(n => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-500">#${n.id}</td>
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium max-w-xs truncate">${n.title}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold">${n.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${n.date}</td>
                                        <td class="px-4 py-3 text-sm">${n.isHot ? 'üî•' : '-'}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="editNews(${n.id})" class="text-blue-600 hover:underline text-sm mr-3">S·ª≠a</button>
                                            <button onclick="deleteNews(${n.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ AGENCIES ============
        async function loadAgenciesContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            try {
                const res = await fetch(API + '/admin/agencies');
                const data = await res.json();
                const agencies = data.data || [];
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üèõÔ∏è Qu·∫£n l√Ω C∆° quan</h2>
                        <button onclick="showAgencyForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">T√™n c∆° quan</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Lo·∫°i</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">T·ªânh/TP</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">SƒêT</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${agencies.map(a => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${a.name}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">${a.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${a.provinceId}</td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${a.phone || '-'}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="deleteAgency(${a.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ SETTINGS - Complete with HTIC info & Privacy Policy ============
        let currentLogo = null;

        async function loadSettingsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const logoRes = await fetch(API + '/settings/logo');
                const logoData = await logoRes.json();
                currentLogo = logoData.data?.logo || null;
                
                content.innerHTML = `
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">‚öôÔ∏è C√†i ƒë·∫∑t App</h2>
                    
                    <!-- Logo Upload -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">üñºÔ∏è Logo App</h3>
                        <div class="flex items-start gap-6">
                            <div class="flex-shrink-0">
                                <div id="logoPreview" class="w-32 h-32 rounded-2xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50">
                                    ${currentLogo ? `<img src="${currentLogo}" class="w-full h-full object-contain"/>` : `<div class="text-center text-gray-400"><span class="text-4xl">H</span><p class="text-xs mt-1">Ch∆∞a c√≥ logo</p></div>`}
                                </div>
                            </div>
                            <div class="flex-1">
                                <p class="text-gray-600 text-sm mb-4">Upload logo c·ªßa c√¥ng ty ƒë·ªÉ hi·ªÉn th·ªã trong app. Khuy·∫øn ngh·ªã: PNG ho·∫∑c JPG, k√≠ch th∆∞·ªõc 200x200 pixels.</p>
                                <div class="space-y-3">
                                    <input type="file" id="logoInput" accept="image/*" onchange="previewLogo(this)" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-navy-50 file:text-navy-700 hover:file:bg-navy-100 cursor-pointer"/>
                                    <div class="flex gap-3">
                                        <button onclick="saveLogo()" id="saveLogoBtn" class="bg-navy-600 text-white px-6 py-2 rounded-xl font-semibold hover:bg-navy-700 disabled:opacity-50" ${!currentLogo ? 'disabled' : ''}>üíæ L∆∞u Logo</button>
                                        <button onclick="removeLogo()" class="bg-red-100 text-red-700 px-6 py-2 rounded-xl font-semibold hover:bg-red-200 ${!currentLogo ? 'hidden' : ''}">üóëÔ∏è X√≥a Logo</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="logoMessage" class="mt-4 hidden"></div>
                    </div>
                    
                    <!-- Th√¥ng tin c√¥ng ty HTIC -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">üè¢ Th√¥ng tin C√¥ng ty Lu·∫≠t HTIC</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">T√™n c√¥ng ty</label>
                                <input type="text" id="companyName" value="HTIC LAW FIRM" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Website</label>
                                <input type="text" id="companyWebsite" value="www.htic.com.vn" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">S·ªë ƒëi·ªán tho·∫°i</label>
                                <input type="text" id="companyPhone" value="0379 044 299" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
                                <input type="email" id="companyEmail" value="contact@htic.com.vn" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">ƒê·ªãa ch·ªâ</label>
                                <input type="text" id="companyAddress" value="H√† N·ªôi, Vi·ªát Nam" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Gi·ªõi thi·ªáu</label>
                                <textarea id="companyIntro" rows="3" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none resize-none">HTIC Law Firm l√† c√¥ng ty lu·∫≠t chuy√™n nghi·ªáp trong lƒ©nh v·ª±c t∆∞ v·∫•n ph√°p l√Ω doanh nghi·ªáp, M&A, v√† c√°c d·ªãch v·ª• ph√°p l√Ω cho doanh nghi·ªáp.</textarea>
                            </div>
                        </div>
                        <button onclick="saveCompanyInfo()" class="mt-4 bg-navy-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-navy-700">üíæ L∆∞u th√¥ng tin c√¥ng ty</button>
                    </div>
                    
                    <!-- Ch√≠nh s√°ch b·∫£o m·∫≠t -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">üîí Ch√≠nh s√°ch b·∫£o m·∫≠t</h3>
                        <textarea id="privacyPolicy" rows="10" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none resize-none text-sm">CH√çNH S√ÅCH B·∫¢O M·∫¨T TH√îNG TIN

1. Thu th·∫≠p th√¥ng tin
- ·ª®ng d·ª•ng HTIC Legal thu th·∫≠p th√¥ng tin c√° nh√¢n khi b·∫°n ƒëƒÉng k√Ω t√†i kho·∫£n, bao g·ªìm: h·ªç t√™n, email, s·ªë ƒëi·ªán tho·∫°i, th√¥ng tin doanh nghi·ªáp (n·∫øu c√≥).
- Ch√∫ng t√¥i c≈©ng thu th·∫≠p th√¥ng tin v·ªÅ c√°ch b·∫°n s·ª≠ d·ª•ng ·ª©ng d·ª•ng ƒë·ªÉ c·∫£i thi·ªán d·ªãch v·ª•.

2. S·ª≠ d·ª•ng th√¥ng tin
- Cung c·∫•p d·ªãch v·ª• nh·∫Øc nh·ªü l·ªãch ph√°p l√Ω
- G·ª≠i th√¥ng b√°o v·ªÅ c√°c deadline quan tr·ªçng
- H·ªó tr·ª£ kh√°ch h√†ng
- C·∫£i thi·ªán ch·∫•t l∆∞·ª£ng ·ª©ng d·ª•ng

3. B·∫£o m·∫≠t th√¥ng tin
- Th√¥ng tin c·ªßa b·∫°n ƒë∆∞·ª£c m√£ h√≥a v√† b·∫£o v·ªá b·∫±ng c√°c bi·ªán ph√°p an ninh ti√™u chu·∫©n ng√†nh.
- Ch√∫ng t√¥i kh√¥ng chia s·∫ª th√¥ng tin c√° nh√¢n c·ªßa b·∫°n v·ªõi b√™n th·ª© ba m√† kh√¥ng c√≥ s·ª± ƒë·ªìng √Ω c·ªßa b·∫°n.

4. Quy·ªÅn c·ªßa ng∆∞·ªùi d√πng
- B·∫°n c√≥ quy·ªÅn truy c·∫≠p, ch·ªânh s·ª≠a ho·∫∑c x√≥a th√¥ng tin c√° nh√¢n c·ªßa m√¨nh b·∫•t k·ª≥ l√∫c n√†o.
- Li√™n h·ªá contact@htic.com.vn ƒë·ªÉ th·ª±c hi·ªán c√°c quy·ªÅn n√†y.

5. Li√™n h·ªá
HTIC LAW FIRM
Email: contact@htic.com.vn
ƒêi·ªán tho·∫°i: 0379 044 299</textarea>
                        <button onclick="savePrivacyPolicy()" class="mt-4 bg-navy-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-navy-700">üíæ L∆∞u ch√≠nh s√°ch</button>
                    </div>
                    
                    <!-- ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">üìã ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</h3>
                        <textarea id="termsOfService" rows="8" class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none resize-none text-sm">ƒêI·ªÄU KHO·∫¢N S·ª¨ D·ª§NG

1. Ch·∫•p nh·∫≠n ƒëi·ªÅu kho·∫£n
B·∫±ng vi·ªác s·ª≠ d·ª•ng ·ª©ng d·ª•ng HTIC Legal, b·∫°n ƒë·ªìng √Ω tu√¢n theo c√°c ƒëi·ªÅu kho·∫£n n√†y.

2. M·ª•c ƒë√≠ch s·ª≠ d·ª•ng
- ·ª®ng d·ª•ng cung c·∫•p th√¥ng tin tham kh·∫£o v·ªÅ l·ªãch ph√°p l√Ω v√† c√°c quy ƒë·ªãnh ph√°p lu·∫≠t.
- Th√¥ng tin trong ·ª©ng d·ª•ng kh√¥ng thay th·∫ø cho t∆∞ v·∫•n ph√°p l√Ω chuy√™n nghi·ªáp.

3. Gi·ªõi h·∫°n tr√°ch nhi·ªám
- HTIC Law Firm kh√¥ng ch·ªãu tr√°ch nhi·ªám v·ªÅ c√°c thi·ªát h·∫°i ph√°t sinh t·ª´ vi·ªác s·ª≠ d·ª•ng th√¥ng tin trong ·ª©ng d·ª•ng.
- Ng∆∞·ªùi d√πng c·∫ßn x√°c minh th√¥ng tin v·ªõi c√°c ngu·ªìn ch√≠nh th·ª©c.

4. Quy·ªÅn s·ªü h·ªØu tr√≠ tu·ªá
N·ªôi dung trong ·ª©ng d·ª•ng thu·ªôc quy·ªÅn s·ªü h·ªØu c·ªßa HTIC Law Firm.</textarea>
                        <button onclick="saveTermsOfService()" class="mt-4 bg-navy-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-navy-700">üíæ L∆∞u ƒëi·ªÅu kho·∫£n</button>
                    </div>
                    
                    <!-- Th√¥ng tin phi√™n b·∫£n -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">‚ÑπÔ∏è Th√¥ng tin ·ª©ng d·ª•ng</h3>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-gray-500 mb-1">Phi√™n b·∫£n</p>
                                <p class="font-bold text-gray-900">8.3.0</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-gray-500 mb-1">C·∫≠p nh·∫≠t</p>
                                <p class="font-bold text-gray-900">29/12/2024</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-gray-500 mb-1">N·ªÅn t·∫£ng</p>
                                <p class="font-bold text-gray-900">Web App (PWA)</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl">
                                <p class="text-gray-500 mb-1">Nh√† ph√°t tri·ªÉn</p>
                                <p class="font-bold text-gray-900">HTIC Law Firm</p>
                            </div>
                        </div>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        function previewLogo(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = function() {
                    currentLogo = reader.result;
                    document.getElementById('logoPreview').innerHTML = `<img src="${currentLogo}" class="w-full h-full object-contain"/>`;
                    document.getElementById('saveLogoBtn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        async function saveLogo() {
            const msgEl = document.getElementById('logoMessage');
            msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-blue-100 text-blue-700';
            msgEl.textContent = 'ƒêang l∆∞u...';
            msgEl.classList.remove('hidden');
            try {
                const res = await fetch(API + '/admin/settings/logo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ logo: currentLogo })
                });
                const data = await res.json();
                if (data.success) {
                    msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-green-100 text-green-700';
                    msgEl.textContent = '‚úÖ Logo ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!';
                } else throw new Error(data.message);
            } catch (e) {
                msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-red-100 text-red-700';
                msgEl.textContent = '‚ùå L·ªói: ' + (e.message || 'Kh√¥ng th·ªÉ l∆∞u logo');
            }
        }

        async function removeLogo() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a logo?')) return;
            try {
                const res = await fetch(API + '/admin/settings/logo', { method: 'DELETE' });
                const data = await res.json();
                if (data.success) {
                    currentLogo = null;
                    document.getElementById('logoPreview').innerHTML = `<div class="text-center text-gray-400"><span class="text-4xl">H</span><p class="text-xs mt-1">Ch∆∞a c√≥ logo</p></div>`;
                    document.getElementById('saveLogoBtn').disabled = true;
                    const msgEl = document.getElementById('logoMessage');
                    msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-green-100 text-green-700';
                    msgEl.textContent = '‚úÖ Logo ƒë√£ ƒë∆∞·ª£c x√≥a!';
                    msgEl.classList.remove('hidden');
                }
            } catch (e) {
                alert('‚ùå L·ªói x√≥a logo');
            }
        }

        async function saveCompanyInfo() {
            alert('‚úÖ ƒê√£ l∆∞u th√¥ng tin c√¥ng ty!');
        }

        async function savePrivacyPolicy() {
            alert('‚úÖ ƒê√£ l∆∞u ch√≠nh s√°ch b·∫£o m·∫≠t!');
        }

        async function saveTermsOfService() {
            alert('‚úÖ ƒê√£ l∆∞u ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng!');
        }

        // ============ DELETE FUNCTIONS ============
        async function deleteEvent(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·ª± ki·ªán n√†y?')) return;
            await fetch(API + '/admin/events/' + id, { method: 'DELETE' });
            loadEventsContent();
        }

        async function deleteNews(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a tin n√†y?')) return;
            await fetch(API + '/admin/news/' + id, { method: 'DELETE' });
            loadNewsContent();
        }

        async function deleteAgency(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a c∆° quan n√†y?')) return;
            await fetch(API + '/admin/agencies/' + id, { method: 'DELETE' });
            loadAgenciesContent();
        }

        // ============ FORM PLACEHOLDERS ============
        function showEventForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn. H√£y th√™m tr·ª±c ti·∫øp v√†o file data/events.json'); }
        function showNewsForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn. H√£y th√™m tr·ª±c ti·∫øp v√†o file data/news.json'); }
        function showAgencyForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn. H√£y th√™m tr·ª±c ti·∫øp v√†o file data/agencies.json'); }
        function editEvent(id) { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function editNews(id) { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }

        checkAuth();
    </script>
</body>
</html>
