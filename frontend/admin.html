<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - HTIC Legal App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>tailwind.config={theme:{extend:{colors:{navy:{50:'#e8eef5',100:'#c5d4e8',500:'#3d6d9e',600:'#1e3a5f',700:'#162d4a'}}}}}</script>
    <style>*{font-family:'Inter',sans-serif}</style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div id="app"></div>
    <script>
        const API = '/api';
        let token = localStorage.getItem('adminToken');
        let currentSection = 'dashboard';

        // DOM Elements
        const app = document.getElementById('app');

        // Check auth
        function checkAuth() {
            if (!token) {
                showLogin();
            } else {
                showDashboard();
            }
        }

        // Login
        function showLogin() {
            app.innerHTML = `
                <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-navy-600 to-navy-700 p-4">
                    <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md">
                        <div class="text-center mb-8">
                            <div class="w-20 h-20 bg-gradient-to-br from-navy-600 to-navy-700 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <span class="text-white text-3xl font-bold">H</span>
                            </div>
                            <h1 class="text-2xl font-bold text-gray-900">HTIC Legal Admin</h1>
                            <p class="text-gray-500 mt-2">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω</p>
                        </div>
                        <div id="loginError" class="hidden bg-red-100 text-red-700 p-3 rounded-lg mb-4 text-sm"></div>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">T√™n ƒëƒÉng nh·∫≠p</label>
                                <input type="text" id="username" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none" placeholder="admin">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">M·∫≠t kh·∫©u</label>
                                <input type="password" id="password" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            </div>
                            <button onclick="login()" class="w-full bg-navy-600 text-white py-3 rounded-xl font-bold hover:bg-navy-700 transition">
                                ƒêƒÉng nh·∫≠p
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorEl = document.getElementById('loginError');

            try {
                const res = await fetch(API + '/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();
                if (data.success) {
                    token = data.token;
                    localStorage.setItem('adminToken', token);
                    showDashboard();
                } else {
                    errorEl.textContent = data.message || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i';
                    errorEl.classList.remove('hidden');
                }
            } catch (e) {
                errorEl.textContent = 'L·ªói k·∫øt n·ªëi server';
                errorEl.classList.remove('hidden');
            }
        }

        function logout() {
            token = null;
            localStorage.removeItem('adminToken');
            showLogin();
        }

        // Dashboard
        async function showDashboard() {
            app.innerHTML = `
                <div class="flex min-h-screen">
                    <!-- Sidebar -->
                    <div class="w-64 bg-navy-700 text-white p-6 fixed h-full">
                        <div class="flex items-center gap-3 mb-8">
                            <div class="w-10 h-10 bg-white rounded-xl flex items-center justify-center">
                                <span class="text-navy-700 font-bold text-lg">H</span>
                            </div>
                            <div>
                                <h1 class="font-bold">HTIC Legal</h1>
                                <p class="text-xs text-navy-200">Admin Panel</p>
                            </div>
                        </div>
                        <nav class="space-y-2">
                            <button onclick="loadSection('dashboard')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="dashboard">
                                <span>üìä</span> T·ªïng quan
                            </button>
                            <button onclick="loadSection('events')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="events">
                                <span>üìÖ</span> S·ª± ki·ªán
                            </button>
                            <button onclick="loadSection('news')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="news">
                                <span>üì∞</span> Tin t·ª©c
                            </button>
                            <button onclick="loadSection('agencies')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="agencies">
                                <span>üèõÔ∏è</span> C∆° quan NN
                            </button>
                            <button onclick="loadSection('businesses')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="businesses">
                                <span>üè¢</span> Doanh nghi·ªáp
                            </button>
                            <button onclick="loadSection('settings')" class="nav-btn w-full text-left px-4 py-3 rounded-xl hover:bg-navy-600 flex items-center gap-3" data-section="settings">
                                <span>‚öôÔ∏è</span> C√†i ƒë·∫∑t App
                            </button>
                        </nav>
                        <button onclick="logout()" class="absolute bottom-6 left-6 right-6 bg-red-500/20 text-red-300 py-3 rounded-xl hover:bg-red-500/30 font-semibold">
                            üö™ ƒêƒÉng xu·∫•t
                        </button>
                    </div>
                    <!-- Main Content -->
                    <div class="ml-64 flex-1 p-8">
                        <div id="content"></div>
                    </div>
                </div>
            `;
            loadSection('dashboard');
        }

        function loadSection(section) {
            currentSection = section;
            // Update active nav
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-navy-600');
                if (btn.dataset.section === section) btn.classList.add('bg-navy-600');
            });
            
            switch(section) {
                case 'dashboard': loadDashboardContent(); break;
                case 'events': loadEventsContent(); break;
                case 'news': loadNewsContent(); break;
                case 'agencies': loadAgenciesContent(); break;
                case 'businesses': loadBusinessesContent(); break;
                case 'settings': loadSettingsContent(); break;
            }
        }

        async function loadDashboardContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const res = await fetch(API + '/admin/stats');
                const data = await res.json();
                const stats = data.data || {};
                
                content.innerHTML = `
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">üìä T·ªïng quan</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-2xl">üìÖ</div>
                                <div>
                                    <p class="text-gray-500 text-sm">S·ª± ki·ªán</p>
                                    <p class="text-2xl font-bold text-gray-900">${stats.events?.total || 0}</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-2xl">üì∞</div>
                                <div>
                                    <p class="text-gray-500 text-sm">Tin t·ª©c</p>
                                    <p class="text-2xl font-bold text-gray-900">${stats.news?.total || 0}</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center text-2xl">üèõÔ∏è</div>
                                <div>
                                    <p class="text-gray-500 text-sm">C∆° quan</p>
                                    <p class="text-2xl font-bold text-gray-900">${stats.agencies?.total || 0}</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center text-2xl">üè¢</div>
                                <div>
                                    <p class="text-gray-500 text-sm">Doanh nghi·ªáp</p>
                                    <p class="text-2xl font-bold text-gray-900">${stats.businesses?.total || 0}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                        <h3 class="font-bold text-gray-900 mb-4">H∆∞·ªõng d·∫´n nhanh</h3>
                        <ul class="space-y-3 text-gray-600">
                            <li>üìÖ <strong>S·ª± ki·ªán:</strong> Qu·∫£n l√Ω c√°c deadline thu·∫ø, BHXH, b√°o c√°o</li>
                            <li>üì∞ <strong>Tin t·ª©c:</strong> ƒêƒÉng tin ph√°p lu·∫≠t m·ªõi</li>
                            <li>üèõÔ∏è <strong>C∆° quan:</strong> Th√¥ng tin c∆° quan nh√† n∆∞·ªõc theo t·ªânh</li>
                            <li>üè¢ <strong>Doanh nghi·ªáp:</strong> Qu·∫£n l√Ω DN Pro hi·ªÉn th·ªã trong app</li>
                            <li>‚öôÔ∏è <strong>C√†i ƒë·∫∑t:</strong> Upload logo, th√¥ng tin app</li>
                        </ul>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ EVENTS ============
        async function loadEventsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const res = await fetch(API + '/admin/events');
                const data = await res.json();
                const events = data.data || [];
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üìÖ Qu·∫£n l√Ω S·ª± ki·ªán</h2>
                        <button onclick="showEventForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Lo·∫°i</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ng√†y</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Tr·∫°ng th√°i</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${events.map(e => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${e.title}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold">${e.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">Ng√†y ${e.dayOfMonth || 20}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 ${e.isActive ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'} rounded-full text-xs font-semibold">${e.isActive ? 'Ho·∫°t ƒë·ªông' : '·∫®n'}</span></td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="editEvent(${e.id})" class="text-blue-600 hover:underline text-sm mr-3">S·ª≠a</button>
                                            <button onclick="deleteEvent(${e.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ NEWS ============
        async function loadNewsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const res = await fetch(API + '/admin/news');
                const data = await res.json();
                const news = data.data || [];
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üì∞ Qu·∫£n l√Ω Tin t·ª©c</h2>
                        <button onclick="showNewsForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Danh m·ª•c</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ng√†y</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${news.map(n => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${n.title}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-semibold">${n.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${n.date}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="editNews(${n.id})" class="text-blue-600 hover:underline text-sm mr-3">S·ª≠a</button>
                                            <button onclick="deleteNews(${n.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ AGENCIES ============
        async function loadAgenciesContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const res = await fetch(API + '/admin/agencies');
                const data = await res.json();
                const agencies = data.data || [];
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üèõÔ∏è Qu·∫£n l√Ω C∆° quan</h2>
                        <button onclick="showAgencyForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">T√™n c∆° quan</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Lo·∫°i</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">T·ªânh/TP</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${agencies.map(a => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${a.name}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">${a.category}</span></td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${a.provinceId}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="deleteAgency(${a.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ BUSINESSES ============
        async function loadBusinessesContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                const res = await fetch(API + '/admin/businesses');
                const data = await res.json();
                const businesses = data.data || [];
                
                content.innerHTML = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">üè¢ Qu·∫£n l√Ω Doanh nghi·ªáp Pro</h2>
                        <button onclick="showBusinessForm()" class="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m m·ªõi</button>
                    </div>
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                        ${businesses.length === 0 ? '<div class="p-8 text-center text-gray-500">Ch∆∞a c√≥ doanh nghi·ªáp n√†o</div>' : `
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">T√™n DN</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ng√†nh</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">SƒêT</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Pro</th>
                                    <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Thao t√°c</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${businesses.map(b => `
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-4 py-3 text-sm text-gray-900 font-medium">${b.name || b.companyName}</td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${b.industry || '-'}</td>
                                        <td class="px-4 py-3 text-sm text-gray-600">${b.phone || '-'}</td>
                                        <td class="px-4 py-3 text-sm"><span class="px-2 py-1 ${b.isPro ? 'bg-amber-100 text-amber-700' : 'bg-gray-100 text-gray-600'} rounded-full text-xs font-semibold">${b.isPro ? 'PRO' : 'Free'}</span></td>
                                        <td class="px-4 py-3 text-right">
                                            <button onclick="deleteBusiness(${b.id})" class="text-red-600 hover:underline text-sm">X√≥a</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>`}
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        // ============ SETTINGS - LOGO UPLOAD ============
        let currentLogo = null;

        async function loadSettingsContent() {
            const content = document.getElementById('content');
            content.innerHTML = '<div class="text-center py-12"><div class="animate-spin w-8 h-8 border-4 border-navy-500 border-t-transparent rounded-full mx-auto"></div></div>';
            
            try {
                // Load current logo
                const logoRes = await fetch(API + '/settings/logo');
                const logoData = await logoRes.json();
                currentLogo = logoData.data?.logo || null;
                
                content.innerHTML = `
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">‚öôÔ∏è C√†i ƒë·∫∑t App</h2>
                    
                    <!-- Logo Upload Section -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <span class="text-xl">üñºÔ∏è</span> Logo App
                        </h3>
                        <div class="flex items-start gap-6">
                            <div class="flex-shrink-0">
                                <div id="logoPreview" class="w-32 h-32 rounded-2xl border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50">
                                    ${currentLogo 
                                        ? `<img src="${currentLogo}" class="w-full h-full object-contain"/>`
                                        : `<div class="text-center text-gray-400"><span class="text-4xl">H</span><p class="text-xs mt-1">Ch∆∞a c√≥ logo</p></div>`
                                    }
                                </div>
                            </div>
                            <div class="flex-1">
                                <p class="text-gray-600 text-sm mb-4">Upload logo c·ªßa c√¥ng ty ƒë·ªÉ hi·ªÉn th·ªã trong app. Khuy·∫øn ngh·ªã: PNG ho·∫∑c JPG, k√≠ch th∆∞·ªõc 200x200 pixels.</p>
                                <div class="space-y-3">
                                    <input type="file" id="logoInput" accept="image/*" onchange="previewLogo(this)" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-navy-50 file:text-navy-700 hover:file:bg-navy-100 cursor-pointer"/>
                                    <div class="flex gap-3">
                                        <button onclick="saveLogo()" id="saveLogoBtn" class="bg-navy-600 text-white px-6 py-2 rounded-xl font-semibold hover:bg-navy-700 disabled:opacity-50 disabled:cursor-not-allowed" ${!currentLogo ? 'disabled' : ''}>
                                            üíæ L∆∞u Logo
                                        </button>
                                        <button onclick="removeLogo()" class="bg-red-100 text-red-700 px-6 py-2 rounded-xl font-semibold hover:bg-red-200 ${!currentLogo ? 'hidden' : ''}">
                                            üóëÔ∏è X√≥a Logo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="logoMessage" class="mt-4 hidden"></div>
                    </div>
                    
                    <!-- App Info Section -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <span class="text-xl">‚ÑπÔ∏è</span> Th√¥ng tin App
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">T√™n App</label>
                                <input type="text" id="appName" value="HTIC LAW FIRM" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">S·ªë ƒëi·ªán tho·∫°i</label>
                                <input type="text" id="appPhone" value="0379 044 299" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
                                <input type="email" id="appEmail" value="contact@htic.com.vn" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-500 focus:outline-none"/>
                            </div>
                            <button onclick="saveAppInfo()" class="bg-navy-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-navy-700">
                                üíæ L∆∞u th√¥ng tin
                            </button>
                        </div>
                    </div>
                `;
            } catch (e) {
                content.innerHTML = '<div class="bg-red-100 text-red-700 p-4 rounded-lg">L·ªói t·∫£i d·ªØ li·ªáu</div>';
            }
        }

        function previewLogo(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = function() {
                    currentLogo = reader.result;
                    document.getElementById('logoPreview').innerHTML = `<img src="${currentLogo}" class="w-full h-full object-contain"/>`;
                    document.getElementById('saveLogoBtn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        async function saveLogo() {
            const msgEl = document.getElementById('logoMessage');
            msgEl.className = 'mt-4 p-3 rounded-lg text-sm';
            msgEl.textContent = 'ƒêang l∆∞u...';
            msgEl.classList.remove('hidden');
            msgEl.classList.add('bg-blue-100', 'text-blue-700');
            
            try {
                const res = await fetch(API + '/admin/settings/logo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ logo: currentLogo })
                });
                const data = await res.json();
                
                if (data.success) {
                    msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-green-100 text-green-700';
                    msgEl.textContent = '‚úÖ Logo ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!';
                } else {
                    throw new Error(data.message);
                }
            } catch (e) {
                msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-red-100 text-red-700';
                msgEl.textContent = '‚ùå L·ªói: ' + (e.message || 'Kh√¥ng th·ªÉ l∆∞u logo');
            }
        }

        async function removeLogo() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a logo?')) return;
            
            const msgEl = document.getElementById('logoMessage');
            try {
                const res = await fetch(API + '/admin/settings/logo', { method: 'DELETE' });
                const data = await res.json();
                
                if (data.success) {
                    currentLogo = null;
                    document.getElementById('logoPreview').innerHTML = `<div class="text-center text-gray-400"><span class="text-4xl">H</span><p class="text-xs mt-1">Ch∆∞a c√≥ logo</p></div>`;
                    document.getElementById('saveLogoBtn').disabled = true;
                    msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-green-100 text-green-700';
                    msgEl.textContent = '‚úÖ Logo ƒë√£ ƒë∆∞·ª£c x√≥a!';
                    msgEl.classList.remove('hidden');
                }
            } catch (e) {
                msgEl.className = 'mt-4 p-3 rounded-lg text-sm bg-red-100 text-red-700';
                msgEl.textContent = '‚ùå L·ªói x√≥a logo';
                msgEl.classList.remove('hidden');
            }
        }

        async function saveAppInfo() {
            const name = document.getElementById('appName').value;
            const phone = document.getElementById('appPhone').value;
            const email = document.getElementById('appEmail').value;
            
            try {
                const res = await fetch(API + '/admin/settings/info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, phone, email })
                });
                const data = await res.json();
                if (data.success) {
                    alert('‚úÖ ƒê√£ l∆∞u th√¥ng tin!');
                }
            } catch (e) {
                alert('‚ùå L·ªói l∆∞u th√¥ng tin');
            }
        }

        // ============ DELETE FUNCTIONS ============
        async function deleteEvent(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·ª± ki·ªán n√†y?')) return;
            await fetch(API + '/admin/events/' + id, { method: 'DELETE' });
            loadEventsContent();
        }

        async function deleteNews(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a tin n√†y?')) return;
            await fetch(API + '/admin/news/' + id, { method: 'DELETE' });
            loadNewsContent();
        }

        async function deleteAgency(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a c∆° quan n√†y?')) return;
            await fetch(API + '/admin/agencies/' + id, { method: 'DELETE' });
            loadAgenciesContent();
        }

        async function deleteBusiness(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a doanh nghi·ªáp n√†y?')) return;
            await fetch(API + '/admin/businesses/' + id, { method: 'DELETE' });
            loadBusinessesContent();
        }

        // ============ FORM PLACEHOLDERS ============
        function showEventForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function showNewsForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function showAgencyForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function showBusinessForm() { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function editEvent(id) { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }
        function editNews(id) { alert('T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn'); }

        // Init
        checkAuth();
    </script>
</body>
</html>
