<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTIC Legal - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>tailwind.config={theme:{extend:{colors:{navy:{50:'#e8eef5',100:'#c5d4e8',200:'#9db5d6',600:'#1e3a5f',700:'#162d4a'}}}}}</script>
    <style>*{font-family:'Inter',sans-serif}.hide-scrollbar::-webkit-scrollbar{display:none}</style>
</head>
<body class="bg-gray-100">
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect}=React;
const API='/api';

// 4 Danh m·ª•c t·ªï ch·ª©c ph√°p l√Ω - kh·ªõp v·ªõi index.html
const AGENCY_CATEGORIES=[
    {id:'government',name:'C∆° quan Nh√† n∆∞·ªõc'},
    {id:'lawfirm',name:'VP Lu·∫≠t s∆∞ / C√¥ng ty Lu·∫≠t'},
    {id:'notary',name:'VƒÉn ph√≤ng C√¥ng ch·ª©ng'},
    {id:'bailiff',name:'VP Th·ª´a ph√°t l·∫°i'}
];

const EVENT_CATEGORIES=[
    {id:'tax',name:'Thu·∫ø'},
    {id:'insurance',name:'BHXH'},
    {id:'report',name:'B√°o c√°o'},
    {id:'license',name:'Gi·∫•y ph√©p'}
];

const FREQUENCIES=[
    {id:'monthly',name:'H√†ng th√°ng'},
    {id:'quarterly',name:'H√†ng qu√Ω'},
    {id:'yearly',name:'H√†ng nƒÉm'}
];

// Login Screen
const LoginScreen=({onLogin})=>{
    const[username,setUsername]=useState('');
    const[password,setPassword]=useState('');
    const[error,setError]=useState('');
    const[loading,setLoading]=useState(false);

    const handleSubmit=async(e)=>{
        e.preventDefault();
        setLoading(true);setError('');
        try{
            const res=await fetch(API+'/admin/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});
            const data=await res.json();
            if(data.success){localStorage.setItem('adminToken',data.token);onLogin();}
            else setError(data.message||'Sai th√¥ng tin ƒëƒÉng nh·∫≠p');
        }catch(err){setError('Kh√¥ng th·ªÉ k·∫øt n·ªëi server');}
        setLoading(false);
    };

    return(
        <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-navy-600 to-navy-700 p-4">
            <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                <div className="text-center mb-8">
                    <div className="w-20 h-20 bg-navy-600 rounded-2xl flex items-center justify-center mx-auto mb-4"><span className="text-white text-3xl font-bold">H</span></div>
                    <h1 className="text-2xl font-bold text-gray-900">HTIC Legal Admin</h1>
                    <p className="text-gray-500 mt-2">ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω</p>
                </div>
                <form onSubmit={handleSubmit} className="space-y-4">
                    <div><label className="block text-sm font-semibold text-gray-700 mb-2">T√™n ƒëƒÉng nh·∫≠p</label><input type="text" value={username} onChange={e=>setUsername(e.target.value)} className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-600 focus:outline-none" placeholder="admin" required/></div>
                    <div><label className="block text-sm font-semibold text-gray-700 mb-2">M·∫≠t kh·∫©u</label><input type="password" value={password} onChange={e=>setPassword(e.target.value)} className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-navy-600 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required/></div>
                    {error&&<p className="text-red-500 text-sm font-medium">{error}</p>}
                    <button type="submit" disabled={loading} className="w-full py-3 bg-navy-600 text-white font-bold rounded-xl hover:bg-navy-700 disabled:opacity-50">{loading?'ƒêang ƒëƒÉng nh·∫≠p...':'ƒêƒÉng nh·∫≠p'}</button>
                </form>
            </div>
        </div>
    );
};

// Modal Component
const Modal=({title,onClose,children})=>(
    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onClick={onClose}>
        <div className="bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-auto" onClick={e=>e.stopPropagation()}>
            <div className="sticky top-0 bg-white px-6 py-4 border-b flex justify-between items-center">
                <h2 className="text-xl font-bold text-gray-900">{title}</h2>
                <button onClick={onClose} className="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600">‚úï</button>
            </div>
            <div className="p-6">{children}</div>
        </div>
    </div>
);

// Dashboard Component
const Dashboard=({onLogout})=>{
    const[activeTab,setActiveTab]=useState('events');
    const[stats,setStats]=useState({events:{total:0},news:{total:0},agencies:{total:0}});
    const[events,setEvents]=useState([]);
    const[news,setNews]=useState([]);
    const[agencies,setAgencies]=useState([]);
    const[provinces,setProvinces]=useState([]);
    const[showModal,setShowModal]=useState(null);
    const[editItem,setEditItem]=useState(null);
    const[loading,setLoading]=useState(true);

    // Fetch data
    useEffect(()=>{
        const fetchAll=async()=>{
            try{
                const[statsRes,eventsRes,newsRes,agenciesRes,provincesRes]=await Promise.all([
                    fetch(API+'/admin/stats'),
                    fetch(API+'/admin/events'),
                    fetch(API+'/admin/news'),
                    fetch(API+'/admin/agencies'),
                    fetch(API+'/provinces')
                ]);
                const[statsData,eventsData,newsData,agenciesData,provincesData]=await Promise.all([
                    statsRes.json(),eventsRes.json(),newsRes.json(),agenciesRes.json(),provincesRes.json()
                ]);
                if(statsData.success)setStats(statsData.data);
                if(eventsData.success)setEvents(eventsData.data);
                if(newsData.success)setNews(newsData.data);
                if(agenciesData.success)setAgencies(agenciesData.data);
                if(provincesData.success)setProvinces(provincesData.data);
            }catch(err){console.error(err);}
            setLoading(false);
        };
        fetchAll();
    },[]);

    // CRUD Functions
    const saveEvent=async(data)=>{
        const method=editItem?'PUT':'POST';
        const url=editItem?`${API}/admin/events/${editItem.id}`:`${API}/admin/events`;
        const res=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
        const result=await res.json();
        if(result.success){
            if(editItem)setEvents(events.map(e=>e.id===editItem.id?result.data:e));
            else setEvents([...events,result.data]);
            setShowModal(null);setEditItem(null);
        }else alert(result.message);
    };

    const deleteEvent=async(id)=>{
        if(!confirm('X√°c nh·∫≠n x√≥a?'))return;
        const res=await fetch(`${API}/admin/events/${id}`,{method:'DELETE'});
        const result=await res.json();
        if(result.success)setEvents(events.filter(e=>e.id!==id));
    };

    const saveNews=async(data)=>{
        const method=editItem?'PUT':'POST';
        const url=editItem?`${API}/admin/news/${editItem.id}`:`${API}/admin/news`;
        const res=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
        const result=await res.json();
        if(result.success){
            if(editItem)setNews(news.map(n=>n.id===editItem.id?result.data:n));
            else setNews([...news,result.data]);
            setShowModal(null);setEditItem(null);
        }else alert(result.message);
    };

    const deleteNews=async(id)=>{
        if(!confirm('X√°c nh·∫≠n x√≥a?'))return;
        const res=await fetch(`${API}/admin/news/${id}`,{method:'DELETE'});
        const result=await res.json();
        if(result.success)setNews(news.filter(n=>n.id!==id));
    };

    const saveAgency=async(data)=>{
        const method=editItem?'PUT':'POST';
        const url=editItem?`${API}/admin/agencies/${editItem.id}`:`${API}/admin/agencies`;
        const res=await fetch(url,{method,headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
        const result=await res.json();
        if(result.success){
            if(editItem)setAgencies(agencies.map(a=>a.id===editItem.id?result.data:a));
            else setAgencies([...agencies,result.data]);
            setShowModal(null);setEditItem(null);
        }else alert(result.message);
    };

    const deleteAgency=async(id)=>{
        if(!confirm('X√°c nh·∫≠n x√≥a?'))return;
        const res=await fetch(`${API}/admin/agencies/${id}`,{method:'DELETE'});
        const result=await res.json();
        if(result.success)setAgencies(agencies.filter(a=>a.id!==id));
    };

    // Event Form
    const EventForm=()=>{
        const[form,setForm]=useState(editItem||{title:'',category:'tax',frequency:'monthly',dayOfMonth:20,month:1,description:'',legalReference:'',penalty:''});
        return(
            <form onSubmit={e=>{e.preventDefault();saveEvent(form);}} className="space-y-4">
                <div><label className="block text-sm font-semibold mb-2">Ti√™u ƒë·ªÅ *</label><input value={form.title} onChange={e=>setForm({...form,title:e.target.value})} className="w-full p-3 border-2 rounded-xl" required/></div>
                <div className="grid grid-cols-2 gap-4">
                    <div><label className="block text-sm font-semibold mb-2">Danh m·ª•c</label><select value={form.category} onChange={e=>setForm({...form,category:e.target.value})} className="w-full p-3 border-2 rounded-xl">{EVENT_CATEGORIES.map(c=><option key={c.id} value={c.id}>{c.name}</option>)}</select></div>
                    <div><label className="block text-sm font-semibold mb-2">T·∫ßn su·∫•t</label><select value={form.frequency} onChange={e=>setForm({...form,frequency:e.target.value})} className="w-full p-3 border-2 rounded-xl">{FREQUENCIES.map(f=><option key={f.id} value={f.id}>{f.name}</option>)}</select></div>
                </div>
                <div className="grid grid-cols-2 gap-4">
                    <div><label className="block text-sm font-semibold mb-2">Ng√†y trong th√°ng</label><input type="number" min="1" max="31" value={form.dayOfMonth} onChange={e=>setForm({...form,dayOfMonth:parseInt(e.target.value)})} className="w-full p-3 border-2 rounded-xl"/></div>
                    {form.frequency==='yearly'&&<div><label className="block text-sm font-semibold mb-2">Th√°ng</label><input type="number" min="1" max="12" value={form.month} onChange={e=>setForm({...form,month:parseInt(e.target.value)})} className="w-full p-3 border-2 rounded-xl"/></div>}
                </div>
                <div><label className="block text-sm font-semibold mb-2">M√¥ t·∫£</label><textarea value={form.description} onChange={e=>setForm({...form,description:e.target.value})} rows={3} className="w-full p-3 border-2 rounded-xl"/></div>
                <div><label className="block text-sm font-semibold mb-2">CƒÉn c·ª© ph√°p l√Ω</label><input value={form.legalReference} onChange={e=>setForm({...form,legalReference:e.target.value})} className="w-full p-3 border-2 rounded-xl"/></div>
                <div><label className="block text-sm font-semibold mb-2">M·ª©c ph·∫°t</label><input value={form.penalty} onChange={e=>setForm({...form,penalty:e.target.value})} className="w-full p-3 border-2 rounded-xl"/></div>
                <button type="submit" className="w-full py-3 bg-navy-600 text-white font-bold rounded-xl hover:bg-navy-700">{editItem?'C·∫≠p nh·∫≠t':'Th√™m m·ªõi'}</button>
            </form>
        );
    };

    // News Form
    const NewsForm=()=>{
        const[form,setForm]=useState(editItem||{title:'',category:'Thu·∫ø',date:new Date().toLocaleDateString('vi-VN'),summary:'',content:'',image:'',isHot:false});
        return(
            <form onSubmit={e=>{e.preventDefault();saveNews(form);}} className="space-y-4">
                <div><label className="block text-sm font-semibold mb-2">Ti√™u ƒë·ªÅ *</label><input value={form.title} onChange={e=>setForm({...form,title:e.target.value})} className="w-full p-3 border-2 rounded-xl" required/></div>
                <div className="grid grid-cols-2 gap-4">
                    <div><label className="block text-sm font-semibold mb-2">Danh m·ª•c</label><input value={form.category} onChange={e=>setForm({...form,category:e.target.value})} className="w-full p-3 border-2 rounded-xl" placeholder="Thu·∫ø, BHXH, Lao dong..."/></div>
                    <div><label className="block text-sm font-semibold mb-2">Ng√†y</label><input value={form.date} onChange={e=>setForm({...form,date:e.target.value})} className="w-full p-3 border-2 rounded-xl" placeholder="25/12/2024"/></div>
                </div>
                <div><label className="block text-sm font-semibold mb-2">T√≥m t·∫Øt *</label><textarea value={form.summary} onChange={e=>setForm({...form,summary:e.target.value})} rows={2} className="w-full p-3 border-2 rounded-xl" required/></div>
                <div><label className="block text-sm font-semibold mb-2">N·ªôi dung</label><textarea value={form.content} onChange={e=>setForm({...form,content:e.target.value})} rows={4} className="w-full p-3 border-2 rounded-xl"/></div>
                <div><label className="block text-sm font-semibold mb-2">URL h√¨nh ·∫£nh</label><input value={form.image} onChange={e=>setForm({...form,image:e.target.value})} className="w-full p-3 border-2 rounded-xl" placeholder="https://..."/></div>
                <label className="flex items-center gap-2"><input type="checkbox" checked={form.isHot} onChange={e=>setForm({...form,isHot:e.target.checked})} className="w-5 h-5"/><span className="font-semibold">üî• Tin n·ªïi b·∫≠t</span></label>
                <button type="submit" className="w-full py-3 bg-navy-600 text-white font-bold rounded-xl hover:bg-navy-700">{editItem?'C·∫≠p nh·∫≠t':'Th√™m m·ªõi'}</button>
            </form>
        );
    };

    // Agency Form - Updated with 4 new categories
    const AgencyForm=()=>{
        const[form,setForm]=useState(editItem||{name:'',category:'government',provinceId:provinces[0]?.id||'',address:'',phone:'',website:''});
        return(
            <form onSubmit={e=>{e.preventDefault();saveAgency(form);}} className="space-y-4">
                <div><label className="block text-sm font-semibold mb-2">T√™n t·ªï ch·ª©c *</label><input value={form.name} onChange={e=>setForm({...form,name:e.target.value})} className="w-full p-3 border-2 rounded-xl" required placeholder="VD: C·ª•c Thu·∫ø TP. H√† N·ªôi"/></div>
                <div className="grid grid-cols-2 gap-4">
                    <div>
                        <label className="block text-sm font-semibold mb-2">Lo·∫°i h√¨nh *</label>
                        <select value={form.category} onChange={e=>setForm({...form,category:e.target.value})} className="w-full p-3 border-2 rounded-xl">
                            {AGENCY_CATEGORIES.map(c=><option key={c.id} value={c.id}>{c.name}</option>)}
                        </select>
                    </div>
                    <div>
                        <label className="block text-sm font-semibold mb-2">T·ªânh/TP *</label>
                        <select value={form.provinceId} onChange={e=>setForm({...form,provinceId:e.target.value})} className="w-full p-3 border-2 rounded-xl">
                            {provinces.map(p=><option key={p.id} value={p.id}>{p.name}</option>)}
                        </select>
                    </div>
                </div>
                <div><label className="block text-sm font-semibold mb-2">ƒê·ªãa ch·ªâ *</label><input value={form.address} onChange={e=>setForm({...form,address:e.target.value})} className="w-full p-3 border-2 rounded-xl" required placeholder="S·ªë nh√†, ƒë∆∞·ªùng, qu·∫≠n/huy·ªán"/></div>
                <div><label className="block text-sm font-semibold mb-2">S·ªë ƒëi·ªán tho·∫°i</label><input value={form.phone} onChange={e=>setForm({...form,phone:e.target.value})} className="w-full p-3 border-2 rounded-xl" placeholder="024 1234 5678"/></div>
                <div><label className="block text-sm font-semibold mb-2">Website</label><input value={form.website} onChange={e=>setForm({...form,website:e.target.value})} className="w-full p-3 border-2 rounded-xl" placeholder="www.example.com"/></div>
                <button type="submit" className="w-full py-3 bg-navy-600 text-white font-bold rounded-xl hover:bg-navy-700">{editItem?'C·∫≠p nh·∫≠t':'Th√™m m·ªõi'}</button>
            </form>
        );
    };

    if(loading)return<div className="min-h-screen flex items-center justify-center"><p className="text-xl font-bold text-gray-600">ƒêang t·∫£i...</p></div>;

    const tabs=[
        {id:'events',name:'S·ª± ki·ªán ph√°p l√Ω',icon:'üìÖ',count:stats.events?.total||0},
        {id:'news',name:'Tin t·ª©c',icon:'üì∞',count:stats.news?.total||0},
        {id:'agencies',name:'T·ªï ch·ª©c ph√°p l√Ω',icon:'üèõÔ∏è',count:stats.agencies?.total||0},
        {id:'settings',name:'C√†i ƒë·∫∑t',icon:'‚öôÔ∏è'}
    ];

    return(
        <div className="min-h-screen bg-gray-100">
            {/* Header */}
            <header className="bg-navy-600 text-white px-6 py-4 flex justify-between items-center">
                <div className="flex items-center gap-3">
                    <div className="w-10 h-10 bg-white rounded-xl flex items-center justify-center"><span className="text-navy-600 font-bold text-xl">H</span></div>
                    <div><h1 className="font-bold text-lg">HTIC Legal Admin</h1><p className="text-sm text-white/70">Qu·∫£n l√Ω h·ªá th·ªëng</p></div>
                </div>
                <button onClick={onLogout} className="bg-white/20 px-4 py-2 rounded-xl text-sm font-semibold hover:bg-white/30">ƒêƒÉng xu·∫•t</button>
            </header>

            <div className="flex">
                {/* Sidebar */}
                <aside className="w-64 bg-white min-h-[calc(100vh-72px)] border-r p-4">
                    <nav className="space-y-2">
                        {tabs.map(t=>(
                            <button key={t.id} onClick={()=>setActiveTab(t.id)} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left font-semibold transition-all ${activeTab===t.id?'bg-navy-600 text-white':'text-gray-700 hover:bg-gray-100'}`}>
                                <span className="text-xl">{t.icon}</span>
                                <span className="flex-1">{t.name}</span>
                                {t.count!==undefined&&<span className={`text-sm px-2 py-0.5 rounded-full ${activeTab===t.id?'bg-white/20':'bg-gray-200'}`}>{t.count}</span>}
                            </button>
                        ))}
                    </nav>
                </aside>

                {/* Main Content */}
                <main className="flex-1 p-6">
                    {/* Events Tab */}
                    {activeTab==='events'&&(
                        <div>
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-2xl font-bold text-gray-900">Qu·∫£n l√Ω S·ª± ki·ªán ph√°p l√Ω</h2>
                                <button onClick={()=>{setEditItem(null);setShowModal('event');}} className="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m s·ª± ki·ªán</button>
                            </div>
                            <div className="bg-white rounded-2xl shadow overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-gray-50"><tr><th className="px-4 py-3 text-left font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Danh m·ª•c</th><th className="px-4 py-3 text-left font-semibold text-gray-700">T·∫ßn su·∫•t</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Ng√†y</th><th className="px-4 py-3"></th></tr></thead>
                                    <tbody className="divide-y">
                                        {events.map(e=>(
                                            <tr key={e.id} className="hover:bg-gray-50">
                                                <td className="px-4 py-3 font-medium">{e.title}</td>
                                                <td className="px-4 py-3"><span className="bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-sm font-semibold">{EVENT_CATEGORIES.find(c=>c.id===e.category)?.name||e.category}</span></td>
                                                <td className="px-4 py-3 text-gray-600">{FREQUENCIES.find(f=>f.id===e.frequency)?.name||e.frequency}</td>
                                                <td className="px-4 py-3 text-gray-600">Ng√†y {e.dayOfMonth}{e.month?`/${e.month}`:''}</td>
                                                <td className="px-4 py-3 text-right">
                                                    <button onClick={()=>{setEditItem(e);setShowModal('event');}} className="text-blue-600 hover:underline mr-3">S·ª≠a</button>
                                                    <button onClick={()=>deleteEvent(e.id)} className="text-red-600 hover:underline">X√≥a</button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* News Tab */}
                    {activeTab==='news'&&(
                        <div>
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-2xl font-bold text-gray-900">Qu·∫£n l√Ω Tin t·ª©c</h2>
                                <button onClick={()=>{setEditItem(null);setShowModal('news');}} className="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m tin</button>
                            </div>
                            <div className="bg-white rounded-2xl shadow overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-gray-50"><tr><th className="px-4 py-3 text-left font-semibold text-gray-700">Ti√™u ƒë·ªÅ</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Danh m·ª•c</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Ng√†y</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Hot</th><th className="px-4 py-3"></th></tr></thead>
                                    <tbody className="divide-y">
                                        {news.sort((a,b)=>b.id-a.id).map(n=>(
                                            <tr key={n.id} className="hover:bg-gray-50">
                                                <td className="px-4 py-3 font-medium">{n.title}</td>
                                                <td className="px-4 py-3"><span className="bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-sm font-semibold">{n.category}</span></td>
                                                <td className="px-4 py-3 text-gray-600">{n.date}</td>
                                                <td className="px-4 py-3">{n.isHot&&<span className="text-orange-500">üî•</span>}</td>
                                                <td className="px-4 py-3 text-right">
                                                    <button onClick={()=>{setEditItem(n);setShowModal('news');}} className="text-blue-600 hover:underline mr-3">S·ª≠a</button>
                                                    <button onClick={()=>deleteNews(n.id)} className="text-red-600 hover:underline">X√≥a</button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* Agencies Tab - Updated */}
                    {activeTab==='agencies'&&(
                        <div>
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-900">Qu·∫£n l√Ω T·ªï ch·ª©c ph√°p l√Ω</h2>
                                    <p className="text-gray-500 mt-1">4 lo·∫°i h√¨nh: C∆° quan Nh√† n∆∞·ªõc, VP Lu·∫≠t s∆∞, VP C√¥ng ch·ª©ng, VP Th·ª´a ph√°t l·∫°i</p>
                                </div>
                                <button onClick={()=>{setEditItem(null);setShowModal('agency');}} className="bg-navy-600 text-white px-4 py-2 rounded-xl font-semibold hover:bg-navy-700">+ Th√™m t·ªï ch·ª©c</button>
                            </div>
                            
                            {/* Stats by category */}
                            <div className="grid grid-cols-4 gap-4 mb-6">
                                {AGENCY_CATEGORIES.map(cat=>{
                                    const count=agencies.filter(a=>a.category===cat.id).length;
                                    return(
                                        <div key={cat.id} className="bg-white rounded-xl p-4 shadow">
                                            <p className="text-sm text-gray-500 font-medium">{cat.name}</p>
                                            <p className="text-2xl font-bold text-gray-900">{count}</p>
                                        </div>
                                    );
                                })}
                            </div>

                            <div className="bg-white rounded-2xl shadow overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-gray-50"><tr><th className="px-4 py-3 text-left font-semibold text-gray-700">T√™n t·ªï ch·ª©c</th><th className="px-4 py-3 text-left font-semibold text-gray-700">Lo·∫°i h√¨nh</th><th className="px-4 py-3 text-left font-semibold text-gray-700">T·ªânh/TP</th><th className="px-4 py-3 text-left font-semibold text-gray-700">SƒêT</th><th className="px-4 py-3"></th></tr></thead>
                                    <tbody className="divide-y">
                                        {agencies.map(a=>(
                                            <tr key={a.id} className="hover:bg-gray-50">
                                                <td className="px-4 py-3"><p className="font-medium">{a.name}</p><p className="text-sm text-gray-500">{a.address}</p></td>
                                                <td className="px-4 py-3"><span className="bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full text-sm font-semibold">{AGENCY_CATEGORIES.find(c=>c.id===a.category)?.name||a.category}</span></td>
                                                <td className="px-4 py-3 text-gray-600">{provinces.find(p=>p.id===a.provinceId)?.name||a.provinceId}</td>
                                                <td className="px-4 py-3 text-gray-600">{a.phone}</td>
                                                <td className="px-4 py-3 text-right">
                                                    <button onClick={()=>{setEditItem(a);setShowModal('agency');}} className="text-blue-600 hover:underline mr-3">S·ª≠a</button>
                                                    <button onClick={()=>deleteAgency(a.id)} className="text-red-600 hover:underline">X√≥a</button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* Settings Tab */}
                    {activeTab==='settings'&&(
                        <div>
                            <h2 className="text-2xl font-bold text-gray-900 mb-6">C√†i ƒë·∫∑t h·ªá th·ªëng</h2>
                            <div className="bg-white rounded-2xl p-6 shadow">
                                <h3 className="font-bold text-lg mb-4">Logo ·ª©ng d·ª•ng</h3>
                                <div className="flex items-center gap-4">
                                    <div className="w-20 h-20 bg-navy-600 rounded-xl flex items-center justify-center"><span className="text-white text-3xl font-bold">H</span></div>
                                    <div><input type="file" accept="image/*" className="text-sm"/><p className="text-gray-500 text-sm mt-1">T·∫£i l√™n logo m·ªõi (PNG, JPG)</p></div>
                                </div>
                            </div>
                        </div>
                    )}
                </main>
            </div>

            {/* Modals */}
            {showModal==='event'&&<Modal title={editItem?'S·ª≠a s·ª± ki·ªán':'Th√™m s·ª± ki·ªán'} onClose={()=>{setShowModal(null);setEditItem(null);}}><EventForm/></Modal>}
            {showModal==='news'&&<Modal title={editItem?'S·ª≠a tin t·ª©c':'Th√™m tin t·ª©c'} onClose={()=>{setShowModal(null);setEditItem(null);}}><NewsForm/></Modal>}
            {showModal==='agency'&&<Modal title={editItem?'S·ª≠a t·ªï ch·ª©c':'Th√™m t·ªï ch·ª©c ph√°p l√Ω'} onClose={()=>{setShowModal(null);setEditItem(null);}}><AgencyForm/></Modal>}
        </div>
    );
};

// Main App
function App(){
    const[isLoggedIn,setIsLoggedIn]=useState(!!localStorage.getItem('adminToken'));
    const handleLogout=()=>{localStorage.removeItem('adminToken');setIsLoggedIn(false);};
    if(!isLoggedIn)return<LoginScreen onLogin={()=>setIsLoggedIn(true)}/>;
    return<Dashboard onLogout={handleLogout}/>;
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
